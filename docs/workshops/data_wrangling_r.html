<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<title>data_wrangling_r</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
<link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #97947a;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #97947a;  padding-left: 4px; }
    div.sourceCode
      { color: #f8f8f2; background-color: #2b2b2b; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #f8f8f2; } /* Normal */
    code span.al { color: #dcc6e0; } /* Alert */
    code span.an { color: #d4d0ab; } /* Annotation */
    code span.at { color: #ffd700; } /* Attribute */
    code span.bn { color: #dcc6e0; } /* BaseN */
    code span.bu { color: #f5ab35; } /* BuiltIn */
    code span.cf { color: #ffa07a; } /* ControlFlow */
    code span.ch { color: #abe338; } /* Char */
    code span.cn { color: #ffa07a; } /* Constant */
    code span.co { color: #d4d0ab; } /* Comment */
    code span.cv { color: #d4d0ab; font-style: italic; } /* CommentVar */
    code span.do { color: #d4d0ab; font-style: italic; } /* Documentation */
    code span.dt { color: #dcc6e0; } /* DataType */
    code span.dv { color: #dcc6e0; } /* DecVal */
    code span.er { color: #dcc6e0; } /* Error */
    code span.ex { color: #ffd700; } /* Extension */
    code span.fl { color: #f5ab35; } /* Float */
    code span.fu { color: #ffd700; } /* Function */
    code span.im { color: #f8f8f2; } /* Import */
    code span.in { color: #d4d0ab; } /* Information */
    code span.kw { color: #ffa07a; } /* Keyword */
    code span.op { color: #00e0e0; } /* Operator */
    code span.ot { color: #ffa07a; } /* Other */
    code span.pp { color: #dcc6e0; } /* Preprocessor */
    code span.sc { color: #00e0e0; } /* SpecialChar */
    code span.ss { color: #abe338; } /* SpecialString */
    code span.st { color: #abe338; } /* String */
    code span.va { color: #f5ab35; } /* Variable */
    code span.vs { color: #abe338; } /* VerbatimString */
    code span.wa { color: #d4d0ab; font-style: italic; } /* Warning */
  </style>
<link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
<link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
<link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
<style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
<style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script><script src="../site_libs/quarto-diagram/mermaid-init.js"></script><link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section id="title-slide" class="slide level2 center" data-menu-title="Data Wrangling in R" data-background-image="images/rainier.png" data-background-size="cover" data-background-color="#4B2E83"><h2></h2>
<p><span class="custom-title">Data Wrangling in R</span></p>
<p><span class="custom-subtitle">CSSCR Workshop</span></p>
<p><span class="custom-subtitle2">19 October 2023</span></p>
<p><span class="custom-subtitle3">Victoria Sass</span></p>
</section><section id="roadmap" class="slide level2"><h2>Roadmap</h2>
<div>
<ul>
<li class="fragment">Importing and Exporting Data</li>
<li class="fragment">Manipulating and Summarizing Data</li>
<li class="fragment">Merging Data</li>
<li class="fragment">Tidying and Reshaping Data</li>
</ul>
</div>
</section><section><section id="importing-and-exporting-data" class="title-slide slide level1 section-title center" data-background-color="#4B2E83"><h1>Importing and Exporting Data</h1>

</section><section id="data-packages" class="slide level2"><h2>Data Packages</h2>
<p>R has a <em>big</em> user base. If you are working with a popular data source, it will often have a devoted R package on <em>CRAN</em> or <em>Github</em>.</p>
<div class="fragment">
<p>Examples:</p>
<ul>
<li>
<a href="https://vincentarelbundock.github.io/WDI/"><code>WDI</code></a>: World Development Indicators (World Bank)</li>
<li>
<a href="https://walker-data.com/tidycensus/"><code>tidycensus</code></a>: Census and American Community Survey</li>
<li>
<a href="https://walker-data.com/tidycensus/"><code>quantmod</code></a>: financial data from Yahoo, FRED, Google</li>
<li>
<a href="https://kjhealy.github.io/gssr/"><code>gssr</code></a>: The General Social Survey Cumulative Data (1972-2021)</li>
<li>
<a href="https://github.com/floswald/psidR"><code>psidR</code></a>: Panel Study of Income Dynamics (basic &amp; public datasets)</li>
</ul>
</div>
<div class="fragment">
<p>If you have an actual data file, you’ll have to import it yourself…</p>
</div>
</section><section id="delimited-text-files" class="slide level2"><h2>Delimited Text Files</h2>
<p>Besides a package, it’s easiest when data is stored in a text file. The most commonly encountered delimitd file is a <strong>.csv</strong>.</p>
<div class="fragment">
<p>A comma-separated values (.csv) file looks like the following:</p>
<pre><code>"Subject","Depression","Sex","Week","HamD","Imipramine"
101,"Non-endogenous","Second",0,26,NA
101,"Non-endogenous","Second",1,22,NA
101,"Non-endogenous","Second",2,18,4.04305
101,"Non-endogenous","Second",3,7,3.93183
101,"Non-endogenous","Second",4,4,4.33073
101,"Non-endogenous","Second",5,3,4.36945
103,"Non-endogenous","First",0,33,NA
103,"Non-endogenous","First",1,24,NA
103,"Non-endogenous","First",2,15,2.77259</code></pre>
</div>
</section></section><section><section id="section" class="title-slide slide level1 section-title center" data-menu-title="`readr``" data-background-image="images/readr.png" data-background-size="contain" data-background-position="center" data-background-color="#B7A57A"><h1></h1>

</section><section id="readr" class="slide level2"><h2><code>readr</code></h2>
<p>R has some built-in functions for importing data, such as <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> and <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>.</p>
<div class="fragment">
<p>The <code>readr</code> package provides similar functions, like <code>read_csv()</code>, that have slightly better features:</p>
<div>
<ul>
<li class="fragment">Faster!</li>
<li class="fragment">Better defaults (e.g.&nbsp;doesn’t automatically convert characters to factors)</li>
<li class="fragment">A <em>bit</em> smarter about dates and times</li>
<li class="fragment">Loading progress bars for large files</li>
</ul>
</div>
</div>
<div class="fragment">
<p><code>readr</code> is one of the core <code>tidyverse</code> packages so loading <code>tidyverse</code> will load it too:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Alternatively, you can just load <code>readr</code> like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(readr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="readr-importing-example" class="slide level2"><h2>
<code>readr</code> Importing Example</h2>
<p>Let’s import some data about song ranks on the Billboard Hot 100 in 2000:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>How do we know it loaded?</p>
</div>
<div class="fragment">
<p>Let’s look at it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">glimpse</span>(billboard_2000_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 317
Columns: 81
$ year         &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 200…
$ artist       &lt;chr&gt; "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Down", "504 …
$ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "The Hardest Part Of ...", "Kr…
$ time         &lt;time&gt; 04:22:00, 03:15:00, 03:53:00, 04:24:00, 03:35:00, 03:24:…
$ date.entered &lt;date&gt; 2000-02-26, 2000-09-02, 2000-04-08, 2000-10-21, 2000-04-…
$ wk1          &lt;dbl&gt; 87, 91, 81, 76, 57, 51, 97, 84, 59, 76, 84, 57, 50, 71, 7…
$ wk2          &lt;dbl&gt; 82, 87, 70, 76, 34, 39, 97, 62, 53, 76, 84, 47, 39, 51, 6…
$ wk3          &lt;dbl&gt; 72, 92, 68, 72, 25, 34, 96, 51, 38, 74, 75, 45, 30, 28, 5…
$ wk4          &lt;dbl&gt; 77, NA, 67, 69, 17, 26, 95, 41, 28, 69, 73, 29, 28, 18, 4…
$ wk5          &lt;dbl&gt; 87, NA, 66, 67, 17, 26, 100, 38, 21, 68, 73, 23, 21, 13, …
$ wk6          &lt;dbl&gt; 94, NA, 57, 65, 31, 19, NA, 35, 18, 67, 69, 18, 19, 13, 3…
$ wk7          &lt;dbl&gt; 99, NA, 54, 55, 36, 2, NA, 35, 16, 61, 68, 11, 20, 11, 34…
$ wk8          &lt;dbl&gt; NA, NA, 53, 59, 49, 2, NA, 38, 14, 58, 65, 9, 17, 1, 29, …
$ wk9          &lt;dbl&gt; NA, NA, 51, 62, 53, 3, NA, 38, 12, 57, 73, 9, 17, 1, 27, …
$ wk10         &lt;dbl&gt; NA, NA, 51, 61, 57, 6, NA, 36, 10, 59, 83, 11, 17, 2, 30,…
$ wk11         &lt;dbl&gt; NA, NA, 51, 61, 64, 7, NA, 37, 9, 66, 92, 1, 17, 2, 36, N…
$ wk12         &lt;dbl&gt; NA, NA, 51, 59, 70, 22, NA, 37, 8, 68, NA, 1, 3, 3, 37, N…
$ wk13         &lt;dbl&gt; NA, NA, 47, 61, 75, 29, NA, 38, 6, 61, NA, 1, 3, 3, 39, N…
$ wk14         &lt;dbl&gt; NA, NA, 44, 66, 76, 36, NA, 49, 1, 67, NA, 1, 7, 4, 49, N…
$ wk15         &lt;dbl&gt; NA, NA, 38, 72, 78, 47, NA, 61, 2, 59, NA, 4, 10, 12, 57,…
$ wk16         &lt;dbl&gt; NA, NA, 28, 76, 85, 67, NA, 63, 2, 63, NA, 8, 17, 11, 63,…
$ wk17         &lt;dbl&gt; NA, NA, 22, 75, 92, 66, NA, 62, 2, 67, NA, 12, 25, 13, 65…
$ wk18         &lt;dbl&gt; NA, NA, 18, 67, 96, 84, NA, 67, 2, 71, NA, 22, 29, 15, 68…
$ wk19         &lt;dbl&gt; NA, NA, 18, 73, NA, 93, NA, 83, 3, 79, NA, 23, 29, 18, 79…
$ wk20         &lt;dbl&gt; NA, NA, 14, 70, NA, 94, NA, 86, 4, 89, NA, 43, 40, 20, 86…
$ wk21         &lt;dbl&gt; NA, NA, 12, NA, NA, NA, NA, NA, 5, NA, NA, 44, 43, 30, NA…
$ wk22         &lt;dbl&gt; NA, NA, 7, NA, NA, NA, NA, NA, 5, NA, NA, NA, 50, 40, NA,…
$ wk23         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 6, NA, NA, NA, NA, 39, NA,…
$ wk24         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 9, NA, NA, NA, NA, 44, NA,…
$ wk25         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 13, NA, NA, NA, NA, NA, NA…
$ wk26         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 14, NA, NA, NA, NA, NA, NA…
$ wk27         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 16, NA, NA, NA, NA, NA, NA…
$ wk28         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 23, NA, NA, NA, NA, NA, NA…
$ wk29         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 22, NA, NA, NA, NA, NA, NA…
$ wk30         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 33, NA, NA, NA, NA, NA, NA…
$ wk31         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 36, NA, NA, NA, NA, NA, NA…
$ wk32         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, 43, NA, NA, NA, NA, NA, NA…
$ wk33         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk34         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk35         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk36         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk37         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk38         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk39         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk40         &lt;dbl&gt; NA, NA, 15, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk41         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk42         &lt;dbl&gt; NA, NA, 13, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk43         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk44         &lt;dbl&gt; NA, NA, 16, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk45         &lt;dbl&gt; NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk46         &lt;dbl&gt; NA, NA, 21, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk47         &lt;dbl&gt; NA, NA, 22, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk48         &lt;dbl&gt; NA, NA, 24, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk49         &lt;dbl&gt; NA, NA, 28, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk50         &lt;dbl&gt; NA, NA, 33, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk51         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk52         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk53         &lt;dbl&gt; NA, NA, 49, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk54         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk55         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk56         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk57         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk58         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk59         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk60         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk61         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk62         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk63         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk64         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk65         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk66         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk67         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk68         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk69         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk70         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk71         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk72         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk73         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk74         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk75         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk76         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
</div>
</section><section id="alternate-solution" class="slide level2"><h2>Alternate Solution</h2>
<p>When you import data from an external file you’ll also see it in the Global Environment tab in the upper-right pane of RStudio:</p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<p>You can also import the data manually!</p>
<p>In the upper right-hand pane of RStudio (make sure you’re in the Environment tab), select:</p>
<p><code>Import Dataset &gt; From Text (readr)</code> and browse to the file on your computer<sup>1</sup>.</p>
</div>
<div class="fragment">
<p><strong>Once you’ve imported the data, you can <code>copy/paste</code> the import code from the console into your file!!</strong></p>
<p>This makes the process <em>reproducible!</em></p>
</div>
</div><div class="column" style="width:50%;">
<p><img data-src="images/data_global_env.png"></p>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Ideally you’ve saved it in your project folder!</p></li></ol></aside></section><section id="manual-data-import" class="slide level2"><h2>Manual Data Import</h2>

<img data-src="images/data_import_manual.png" class="r-stretch quarto-figure-center"></section><section id="specifying-nas" class="slide level2"><h2>Specifying <code>NA</code>s</h2>
<p>Sometimes a particular dataset or file read from a different software will code <code>NA</code>s differently than <code>R</code>. If that’s the case, you can add additional specifications to <code>read_csv</code> for what to read in as <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<span id="cb7-2"><a href="#cb7-2"></a>                               <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"N/A"</span>, <span class="st">"999"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="skipping-lines" class="slide level2"><h2>Skipping lines</h2>
<p>Depending on how the data were input, there may be several lines that precede the beginning of the data table you’re interested in importing. You can skip these lines of metadata with the <code>skip</code> argument:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<span id="cb8-2"><a href="#cb8-2"></a>                               <span class="at">skip =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="variable-names" class="slide level2"><h2>Variable names</h2>
<p><code>read_csv</code> will automatically take the first row as column names. If you want to rename them you can save yourself some time recoding later on if you specify your preferred variable names upfront with the <code>col_names</code> argument.</p>
<div class="fragment">
<p>It takes a character vector to be used as column names (in their order of appearance).</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-8"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-8-1"><a href="#annotated-cell-8-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<span id="annotated-cell-8-2"><a href="#annotated-cell-8-2"></a>                               <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"artist"</span>, <span class="st">"track"</span>, <span class="st">"time"</span>, <span class="st">"date_entered"</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="1">1</button><span id="annotated-cell-8-3" class="code-annotation-target"><a href="#annotated-cell-8-3"></a>                                             <span class="fu">paste</span>(<span class="st">"wk"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">76</span>, <span class="at">sep =</span> <span class="st">"_"</span>)))</span>
<span id="annotated-cell-8-4"><a href="#annotated-cell-8-4"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-8" data-target-annotation="2">2</button><span id="annotated-cell-8-5" class="code-annotation-target"><a href="#annotated-cell-8-5"></a>billboard_renamed <span class="sc">|&gt;</span>  <span class="fu">names</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-8" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-lines="3" data-code-cell="annotated-cell-8">First few entries: “wk_1” “wk_2” “wk_3”</span>
</dd>
<dt data-target-cell="annotated-cell-8" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-lines="5" data-code-cell="annotated-cell-8"><code>names</code> returns the column names.</span>
</dd>
</dl>
</div>
</div>
</div>
<div class="fragment">
<p>If you don’t have any variable names you can specify that instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="|2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<span id="cb9-2"><a href="#cb9-2"></a>                               <span class="at">col_names =</span> <span class="cn">FALSE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section><section id="snake-case" class="slide level2"><h2>Snake Case</h2>
<p>If you simply want to change your variables to snake case (all lower case; words separated by <code>_</code>), you can use the function <code>clean_names()</code> from the <code>janitor</code> package which replaces other punctuation separators with <code>_</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-10"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-10-1"><a href="#annotated-cell-10-1"></a><span class="co"># Download pacakge first</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="3">3</button><span id="annotated-cell-10-2" class="code-annotation-target"><a href="#annotated-cell-10-2"></a><span class="co"># install.packages("janitor")</span></span>
<span id="annotated-cell-10-3"><a href="#annotated-cell-10-3"></a></span>
<span id="annotated-cell-10-4"><a href="#annotated-cell-10-4"></a><span class="co"># Create new object for renamed data</span></span>
<span id="annotated-cell-10-5"><a href="#annotated-cell-10-5"></a>billboard_renamed <span class="ot">&lt;-</span> billboard_2000_raw <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-10" data-target-annotation="4">4</button><span id="annotated-cell-10-6" class="code-annotation-target"><a href="#annotated-cell-10-6"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>(<span class="at">numerals =</span> <span class="st">"right"</span>)</span>
<span id="annotated-cell-10-7"><a href="#annotated-cell-10-7"></a></span>
<span id="annotated-cell-10-8"><a href="#annotated-cell-10-8"></a>billboard_renamed <span class="sc">|&gt;</span>  <span class="fu">names</span>() <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-10" data-target-annotation="3">3</dt>
<dd>
<span data-code-annotation="3" data-code-lines="2" data-code-cell="annotated-cell-10">Run in the console first.</span>
</dd>
<dt data-target-cell="annotated-cell-10" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-lines="6" data-code-cell="annotated-cell-10">You can call a function without loading its package by specifying its package name followed by <code>::</code> before it; <br> The <code>numerals</code> argument specifies if you additionally want to put a separator before a number.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "year"         "artist"       "track"        "time"         "date_entered"
 [6] "wk_1"         "wk_2"         "wk_3"         "wk_4"         "wk_5"        </code></pre>
</div>
</div>
</section><section id="other-data-file-types-with-readr" class="slide level2"><h2>Other Data File Types with <code>readr</code>
</h2>
<p>The other functions in <code>readr</code> employ a similar approach to <code>read_csv</code> so the trick is just knowing which to use for what data type.</p>
<div class="fragment">
<ul>
<li>
<code>read_csv2</code> is separated by semicolons (instead of commas)</li>
<li>
<code>read_tsv</code> is separated by tabs</li>
<li>
<code>read_delim</code> guesses the delimiter</li>
<li>
<code>read_fwf</code> reads in fixed-width-files</li>
<li>
<code>read_table</code> is a variation of <code>fwf</code> where columns are separated by white space</li>
<li>
<code>read_log</code> reads in Apache-style log files</li>
</ul>
</div>
</section><section id="other-packages-to-read-in-data" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
</section><section id="other-packages-to-read-in-data-1" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/readxl.png" class="absolute" style="top: 185px; left: 135px; "></p>
</div><div class="column" style="width:50%;">
<ul>
<li>For Excel files (<code>.xls</code> or <code>.xlsx</code>), use package <a href="https://readxl.tidyverse.org/"><code>readxl</code></a><sup>1</sup>
</li>
</ul>
</div>
</div>

<aside><div>
<p>Note: For Excel files and Googlesheets You <strong>won’t</strong> keep text formatting, color, comments, or merged cells. See the <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a> package for those capabilities. Also, <a href="https://github.com/nacnudus/tidyxl"><code>tidyxl</code></a> can help import non-tabular data from Excel.</p>
</div><ol class="aside-footnotes"><li id="fn2"><p>Functions have additional arguments to read in specific sheets or a range of cells.</p></li></ol></aside></section><section id="other-packages-to-read-in-data-2" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/googlesheets4.png" class="absolute" style="top: 185px; left: 135px; "></p>
</div><div class="column" style="width:50%;">
<ul>
<li>For Excel files (<code>.xls</code> or <code>.xlsx</code>), use package <a href="https://readxl.tidyverse.org/"><code>readxl</code></a><sup>1</sup>
</li>
<li>For Google Docs Spreadsheets, use package <a href="https://googlesheets4.tidyverse.org/"><code>googlesheets4</code></a><sup>2</sup>
</li>
</ul>
</div>
</div>

<aside><div>
<p>Note: For Excel files and Googlesheets You <strong>won’t</strong> keep text formatting, color, comments, or merged cells. See the <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a> package for those capabilities. Also, <a href="https://github.com/nacnudus/tidyxl"><code>tidyxl</code></a> can help import non-tabular data from Excel.</p>
</div><ol class="aside-footnotes"><li id="fn3"><p>Functions have additional arguments to read in specific sheets or a range of cells.</p></li><li id="fn4"><p>Very similar to <code>readxl</code> with some slight variations you can read about <a href="https://r4ds.hadley.nz/spreadsheets.html#google-sheets">here</a>.</p></li></ol></aside></section><section id="other-packages-to-read-in-data-3" class="slide level2"><h2>Other Packages to Read in Data</h2>
<p>There are a range of other ways, besides delimited files, that data are stored.</p>
<p>The following packages are part of the extended <code>tidyverse</code> and therefore operate with similar syntax and logic as <code>readr</code>.</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="images/haven.png" class="absolute" style="top: 185px; left: 135px; "></p>
</div><div class="column" style="width:50%;">
<ul>
<li>For Excel files (<code>.xls</code> or <code>.xlsx</code>), use package <a href="https://readxl.tidyverse.org/"><code>readxl</code></a><sup>1</sup>
</li>
<li>For Google Docs Spreadsheets, use package <a href="https://googlesheets4.tidyverse.org/"><code>googlesheets4</code></a><sup>2</sup>
</li>
<li>For Stata, SPSS, and SAS files, use package <a href="https://haven.tidyverse.org/"><code>haven</code></a><sup>3</sup>
</li>
</ul>
</div>
</div>

<aside><div>
<p>Note: For Excel files and Googlesheets You <strong>won’t</strong> keep text formatting, color, comments, or merged cells. See the <a href="https://ycphs.github.io/openxlsx/"><code>openxlsx</code></a> package for those capabilities. Also, <a href="https://github.com/nacnudus/tidyxl"><code>tidyxl</code></a> can help import non-tabular data from Excel.</p>
</div><ol class="aside-footnotes"><li id="fn5"><p>Functions have additional arguments to read in specific sheets or a range of cells.</p></li><li id="fn6"><p>Very similar to <code>readxl</code> with some slight variations you can read about <a href="https://r4ds.hadley.nz/spreadsheets.html#google-sheets">here</a>.</p></li><li id="fn7"><p>SAS, SPSS, and Stata have so-called “labelled” vectors for which <code>haven</code> provides a <a href="https://haven.tidyverse.org/reference/index.html#labelled-vectors">class</a> to represent in <code>R</code>. Alternatively, you can get rid of them with <a href="https://haven.tidyverse.org/reference/index.html#remove-attributes">these functions</a>.</p></li></ol></aside></section><section id="how-does-readr-parse-different-data-types" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id2 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id3 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id4 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id5 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-1" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id2 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id3 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id4 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id5 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style A fill:#B7A57A,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-2" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id2 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id3 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id4 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id5 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#B7A57A,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-3" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id2 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id3 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id4 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id5 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#B7A57A,color:#000000,stroke:#000000
    style D fill:#FFFFFF,color:#000000,stroke:#000000

</pre>
</div>
</div>
</div>
</div>
</section><section id="how-does-readr-parse-different-data-types-4" class="slide level2"><h2>How does <code>readr</code> parse different data types?</h2>
<p>For each column in a data frame, <code>readr</code> functions pull the first 1000 rows and checks:</p>
<div class="cell" data-reveal="true" data-fig-width="11" data-fig-height="5.5" data-layout-align="center">
<div class="cell-output-display">
<div>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    id1((Variable))==&gt;A(["1. Does it contain only F, T, FALSE, TRUE, or NA (ignoring case)?"])==&gt;id2{{Logical}}
    id1((Variable))==&gt;B(["2. Does it contain only numbers (e.g., 1, -4.5, 5e6, Inf?)"])==&gt;id3{{Number}}
    id1((Variable))==&gt;C(["3. Does it match the ISO8601 standard?"])==&gt;id4{{Date/Date-time}}
    id1((Variable))==&gt;D(["4. None of the above"])==&gt;id5{{String}}
    style id1 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style id2 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id3 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id4 fill:#B7A57A,color:#4B2E83,stroke:#4B2E83
    style id5 fill:#4B2E83,color:#B7A57A,stroke:#B7A57A
    style A fill:#FFFFFF,color:#000000,stroke:#000000
    style B fill:#FFFFFF,color:#000000,stroke:#000000
    style C fill:#FFFFFF,color:#000000,stroke:#000000
    style D fill:#B7A57A,color:#000000,stroke:#000000

</pre>
</div>
</div>
</div>
</div>
</section><section id="most-common-issue-with-reading-in-data" class="slide level2"><h2>Most Common Issue with Reading in Data</h2>
<p>The most common problem that occurs when reading in data is having mixed data. Most often, given the heuristic provided in the last slide, will parse a variable as a character string to preserve whatever it contains.</p>
<div class="fragment">
<p>Let’s actually look at how the billboard data was read in:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">glimpse</span>(billboard_2000_raw) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 317
Columns: 81
$ year         &lt;dbl&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 200…
$ artist       &lt;chr&gt; "2 Pac", "2Ge+her", "3 Doors Down", "3 Doors Down", "504 …
$ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "The Hardest Part Of ...", "Kr…
$ time         &lt;time&gt; 04:22:00, 03:15:00, 03:53:00, 04:24:00, 03:35:00, 03:24:…
$ date.entered &lt;date&gt; 2000-02-26, 2000-09-02, 2000-04-08, 2000-10-21, 2000-04-…
$ wk1          &lt;dbl&gt; 87, 91, 81, 76, 57, 51, 97, 84, 59, 76, 84, 57, 50, 71, 7…
$ wk2          &lt;dbl&gt; 82, 87, 70, 76, 34, 39, 97, 62, 53, 76, 84, 47, 39, 51, 6…
$ wk3          &lt;dbl&gt; 72, 92, 68, 72, 25, 34, 96, 51, 38, 74, 75, 45, 30, 28, 5…
$ wk4          &lt;dbl&gt; 77, NA, 67, 69, 17, 26, 95, 41, 28, 69, 73, 29, 28, 18, 4…
$ wk5          &lt;dbl&gt; 87, NA, 66, 67, 17, 26, 100, 38, 21, 68, 73, 23, 21, 13, …
$ wk6          &lt;dbl&gt; 94, NA, 57, 65, 31, 19, NA, 35, 18, 67, 69, 18, 19, 13, 3…
$ wk7          &lt;dbl&gt; 99, NA, 54, 55, 36, 2, NA, 35, 16, 61, 68, 11, 20, 11, 34…
$ wk8          &lt;dbl&gt; NA, NA, 53, 59, 49, 2, NA, 38, 14, 58, 65, 9, 17, 1, 29, …
$ wk9          &lt;dbl&gt; NA, NA, 51, 62, 53, 3, NA, 38, 12, 57, 73, 9, 17, 1, 27, …
$ wk10         &lt;dbl&gt; NA, NA, 51, 61, 57, 6, NA, 36, 10, 59, 83, 11, 17, 2, 30,…
$ wk11         &lt;dbl&gt; NA, NA, 51, 61, 64, 7, NA, 37, 9, 66, 92, 1, 17, 2, 36, N…
$ wk12         &lt;dbl&gt; NA, NA, 51, 59, 70, 22, NA, 37, 8, 68, NA, 1, 3, 3, 37, N…
$ wk13         &lt;dbl&gt; NA, NA, 47, 61, 75, 29, NA, 38, 6, 61, NA, 1, 3, 3, 39, N…
$ wk14         &lt;dbl&gt; NA, NA, 44, 66, 76, 36, NA, 49, 1, 67, NA, 1, 7, 4, 49, N…
$ wk15         &lt;dbl&gt; NA, NA, 38, 72, 78, 47, NA, 61, 2, 59, NA, 4, 10, 12, 57,…
$ wk16         &lt;dbl&gt; NA, NA, 28, 76, 85, 67, NA, 63, 2, 63, NA, 8, 17, 11, 63,…
$ wk17         &lt;dbl&gt; NA, NA, 22, 75, 92, 66, NA, 62, 2, 67, NA, 12, 25, 13, 65…
$ wk18         &lt;dbl&gt; NA, NA, 18, 67, 96, 84, NA, 67, 2, 71, NA, 22, 29, 15, 68…
$ wk19         &lt;dbl&gt; NA, NA, 18, 73, NA, 93, NA, 83, 3, 79, NA, 23, 29, 18, 79…
$ wk20         &lt;dbl&gt; NA, NA, 14, 70, NA, 94, NA, 86, 4, 89, NA, 43, 40, 20, 86…
$ wk21         &lt;dbl&gt; NA, NA, 12, NA, NA, NA, NA, NA, 5, NA, NA, 44, 43, 30, NA…
$ wk22         &lt;dbl&gt; NA, NA, 7, NA, NA, NA, NA, NA, 5, NA, NA, NA, 50, 40, NA,…
$ wk23         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 6, NA, NA, NA, NA, 39, NA,…
$ wk24         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 9, NA, NA, NA, NA, 44, NA,…
$ wk25         &lt;dbl&gt; NA, NA, 6, NA, NA, NA, NA, NA, 13, NA, NA, NA, NA, NA, NA…
$ wk26         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 14, NA, NA, NA, NA, NA, NA…
$ wk27         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, 16, NA, NA, NA, NA, NA, NA…
$ wk28         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 23, NA, NA, NA, NA, NA, NA…
$ wk29         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 22, NA, NA, NA, NA, NA, NA…
$ wk30         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 33, NA, NA, NA, NA, NA, NA…
$ wk31         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, 36, NA, NA, NA, NA, NA, NA…
$ wk32         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, 43, NA, NA, NA, NA, NA, NA…
$ wk33         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk34         &lt;dbl&gt; NA, NA, 3, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk35         &lt;dbl&gt; NA, NA, 4, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk36         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk37         &lt;dbl&gt; NA, NA, 5, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk38         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk39         &lt;dbl&gt; NA, NA, 9, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wk40         &lt;dbl&gt; NA, NA, 15, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk41         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk42         &lt;dbl&gt; NA, NA, 13, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk43         &lt;dbl&gt; NA, NA, 14, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk44         &lt;dbl&gt; NA, NA, 16, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk45         &lt;dbl&gt; NA, NA, 17, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk46         &lt;dbl&gt; NA, NA, 21, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk47         &lt;dbl&gt; NA, NA, 22, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk48         &lt;dbl&gt; NA, NA, 24, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk49         &lt;dbl&gt; NA, NA, 28, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk50         &lt;dbl&gt; NA, NA, 33, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk51         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk52         &lt;dbl&gt; NA, NA, 42, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk53         &lt;dbl&gt; NA, NA, 49, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk54         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk55         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk56         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk57         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk58         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk59         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk60         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk61         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk62         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk63         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk64         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk65         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk66         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk67         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk68         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk69         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk70         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk71         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk72         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk73         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk74         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk75         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ wk76         &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
</div>
</section><section id="what-went-wrong" class="slide level2"><h2>What Went Wrong?</h2>
<p>Since <code>readr</code> uses the values in the first 1000 rows to guess the type of the column (logical, numeric, date/date-time, character), if the first 1000 rows don’t have any data, they will be coded as logical variables.</p>
<div class="fragment">
<p>There are not many songs in the data that charted for 60+ weeks—and none in the first 1000 that charted for 66+ weeks!</p>
</div>
<div class="fragment">
<div class="callout callout-note no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:blue"><i class="fa-solid fa-circle-info" aria-label="circle-info"></i></span> &nbsp;<code>NA</code> is logical?</strong></p>
</div>
<div class="callout-content">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-1-1"><a href="#annotated-cell-1-1"></a><span class="fu">class</span>(<span class="fu">c</span>(T, F, <span class="cn">NA</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>))</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5">5</button><span id="annotated-cell-1-2" class="code-annotation-target"><a href="#annotated-cell-1-2"></a><span class="fu">class</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="cn">NA</span>, <span class="fl">17.5</span>, <span class="fl">5.3</span>, <span class="cn">NA</span>))</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="6">6</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3"></a><span class="fu">class</span>(<span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">"2023-10-31"</span>, <span class="st">"1986-06-21"</span>, <span class="st">"1997-01-15"</span>), <span class="at">tz =</span> <span class="st">"America/Los_Angeles"</span>))</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4"></a><span class="fu">class</span>(<span class="fu">c</span>(<span class="st">"apple"</span>, <span class="cn">NA</span>, <span class="st">"mango"</span>, <span class="st">"blackberry"</span>, <span class="st">"plum"</span>)) </span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5"></a><span class="fu">class</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-annotation="5" data-code-lines="2" data-code-cell="annotated-cell-1"><code>class</code> returns the data type of its first argument.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="6">6</dt>
<dd>
<span data-code-annotation="6" data-code-lines="3" data-code-cell="annotated-cell-1"><code>as.Date</code> turns a character string of dates into an official date class in Base <code>R</code>. If we had an accompanying time stamp we would need to use <code>as.POSIXct</code> which turns a character string of dates and times into an official date-time class in Base <code>R</code>.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "logical"
[1] "numeric"
[1] "Date"
[1] "character"
[1] "logical"</code></pre>
</div>
</div>
</div>
</div>
</div>

</div>
<aside><div>
<p>Technically, <code>NA</code>s can be any data type depending upon what they are grouped with. However, by themselves they are a logical indicator of missing data, so their class is logical.</p>
</div></aside></section><section id="column-types" class="slide level2"><h2>Column types</h2>
<p>Since the <code>wk*</code> variables should all be read in as integers, we can specify this explicitly with the <code>col_types</code> argument.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-12"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-12-1"><a href="#annotated-cell-12-1"></a><span class="co"># Create character string of shortcode column types</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-12" data-target-annotation="7">7</button><span id="annotated-cell-12-2" class="code-annotation-target"><a href="#annotated-cell-12-2"></a>bb_types <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">c</span>(<span class="st">"icctD"</span>, <span class="fu">rep</span>(<span class="st">"i"</span>, <span class="dv">76</span>)), <span class="at">collapse=</span><span class="st">""</span>)</span>
<span id="annotated-cell-12-3"><a href="#annotated-cell-12-3"></a>bb_types </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-12" data-target-annotation="7">7</dt>
<dd>
<span data-code-annotation="7" data-code-lines="2" data-code-cell="annotated-cell-12">You can short-code column types with <code>i</code> = integer, <code>c</code> = character, <code>t</code> = time, <code>D</code> = date. <br> The <code>collapse</code> argument collapses the first two arguments into one complete character string.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "icctDiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-13"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-13-1"><a href="#annotated-cell-13-1"></a><span class="co"># re-read in data with column types specified</span></span>
<span id="annotated-cell-13-2"><a href="#annotated-cell-13-2"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-13" data-target-annotation="8">8</button><span id="annotated-cell-13-3" class="code-annotation-target"><a href="#annotated-cell-13-3"></a>                               <span class="at">col_types =</span> bb_types)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-13" data-target-annotation="8">8</dt>
<dd>
<span data-code-annotation="8" data-code-lines="3" data-code-cell="annotated-cell-13">See all column types and short codes <a href="https://readr.tidyverse.org/reference/cols.html">here</a>.</span>
</dd>
</dl>
</div>
</div>
</div>
</section><section id="column-types-1" class="slide level2"><h2>Column types</h2>
<p>To specify a default column type you can use <code>.default</code> like so:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                               <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="fu">col_character</span>())) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p><br></p>
<p>Another useful helper is <code>cols_only()</code> for when you only want to read in a subset of all available variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>billboard_2000_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">"data/billboard.csv"</span>, </span>
<span id="cb16-2"><a href="#cb16-2"></a>                               <span class="at">col_types =</span> <span class="fu">cols_only</span>(<span class="at">x =</span> col_character)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p><br></p>
<p>In summary, the <code>col-types</code> argument gives you greater control over how your data are read in and can save you recoding time down the road and/or point out where your data are behaving differently than you expect.</p>
</div>
</section><section id="writing-delimited-files" class="slide level2"><h2>Writing Delimited Files</h2>
<p>Getting data out of R into a delimited file is very similar to getting it into R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">write_csv</span>(billboard_2000_raw, <span class="at">path =</span> <span class="st">"data/billboard_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This saved the data we pulled off the web in a file called <code>billboard_data.csv</code> in the <code>data</code> folder of my working directory.</p>
<div class="fragment">
<p>However, saving data in this way will not preserve <code>R</code> data types since delimited files code everything as a character string.</p>
</div>
<div class="fragment">
<p>To save <code>R</code> objects and all associated metadata you have two options:</p>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-1-1"><code>.Rds</code> format:</a></li>
<li><a href="#tabset-1-2"><code>.Rdata</code> or <code>.Rda</code> format:</a></li>
</ul>
<div class="tab-content">
<div id="tabset-1-1">
<ul>
<li>Used for single objects, doesn’t save original the object name</li>
<li>Save: <code>write_rds(old_object_name, "path.Rds")</code>
</li>
<li>Load: <code>new_object_name &lt;- read_rds("path.Rds")</code>
</li>
</ul>
</div>
<div id="tabset-1-2">
<ul>
<li>Used for saving multiple files where the original object names are preserved</li>
<li>Save: <code>save(object1, object2, ... , file = "path.Rdata")</code>
</li>
<li>Load: <code>load("path.Rdata")</code> without assignment operator</li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="writing-other-file-types" class="slide level2"><h2>Writing Other File-Types</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-2-1"><code>writexl</code></a></li>
<li><a href="#tabset-2-2"><code>googlesheets4</code></a></li>
<li><a href="#tabset-2-3"><code>haven</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>
<code>write_xlsx()</code> writes to an xlsx file</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/writexl.png" style="width:50.0%"></p>
</div>
</div>
</div>
<div id="tabset-2-2">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>
<code>sheet_write()</code> or <code>write_sheet()</code> (over)writes new data into a Sheet</li>
<li>
<code>gs4_create()</code> creates a new Sheet</li>
<li>
<code>sheet_append()</code> appends rows to a sheet</li>
<li>
<code>range_write()</code> (over)writes new data into a range</li>
<li>
<code>range_flood()</code> floods a range of cells</li>
<li>`<code>range_clear()</code> clears a range of cells</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/googlesheets4.png" style="width:50.0%"></p>
</div>
</div>
</div>
<div id="tabset-2-3">
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>
<code>write_dta()</code> writes Stata DTA files</li>
<li>
<code>write_sav()</code> writes SPSS files</li>
<li>
<code>write_xpt()</code> writes SAS transport files</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="images/haven.png" style="width:50.0%"></p>
</div>
</div>
</div>
</div>
</div>
</section></section><section><section id="manipulating-and-summarizing-data" class="title-slide slide level1 section-title center" data-background-color="#4B2E83"><h1>Manipulating and Summarizing Data</h1>

</section><section id="death-to-spreadsheets" class="slide level2"><h2>Death to Spreadsheets</h2>
<p>Tools like <em>Excel</em> or <em>Google Sheets</em> let you manipulate spreadsheets using functions.</p>
<div>
<ul>
<li class="fragment">Spreadsheets are <em>not reproducible</em>: It’s hard to know how someone changed the raw data!</li>
<li class="fragment">It’s hard to catch mistakes when you use spreadsheets<sup>1</sup>.</li>
</ul>
</div>
<div class="fragment">
<p>We want to know how to use <code>R</code> to manipulate data more <em>transparently</em> and <em>reproducibly</em>.</p>
</div>
<aside><ol class="aside-footnotes"><li id="fn8"><p>Don’t be the next sad Research Assistant who makes headlines with an Excel error! (<a href="http://www.bloomberg.com/news/articles/2013-04-18/faq-reinhart-rogoff-and-the-excel-error-that-changed-history">Reinhart &amp; Rogoff, 2010</a>)</p></li></ol></aside></section></section><section><section id="logical-operators" class="title-slide slide level1 section-title center" data-background-color="#B7A57A"><h1>Logical Operators</h1>

</section><section id="data-types-in-r" class="slide level2"><h2>Data types in <code>R</code>
</h2>
<p>There are a variety of data types in <code>R</code>:</p>
<div class="fragment">
<ul>
<li>Factors</li>
<li>Date/Date-time</li>
<li>Logical</li>
<li>Numeric</li>
<li>Missing Values</li>
<li>Strings</li>
</ul>
</div>
</section><section id="data-types-in-r-1" class="slide level2"><h2>Data types in <code>R</code>
</h2>
<p>There are a variety of data types in <code>R</code>:</p>
<ul>
<li>Factors</li>
<li>Date/Date-time</li>
<li><span style="color:#e15759">Logical</span></li>
<li>Numeric</li>
<li>Missing Values</li>
<li>Strings</li>
</ul></section><section id="logical-operators-in-r" class="slide level2"><h2>Logical Operators in <code>R</code>
</h2>
<h4 id="comparing-objects">Comparing objects</h4>
<div class="columns">
<div class="column" style="width:19%;">
<div class="fragment">
<ul>
<li>
<code>==</code>:</li>
<li>
<code>!=</code>:</li>
<li>
<code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>:</li>
<li>
<code>%in%</code>:</li>
</ul>
</div>
</div><div class="column" style="width:81%;">
<div class="fragment">
<ul>
<li>is equal to<sup>1</sup>
</li>
<li>not equal to</li>
<li>less than, less than or equal to, etc.</li>
<li>used when checking if equal to one of several values</li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<!-- -->
<h4 id="combining-comparisons">Combining comparisons</h4>
</div>
<div class="columns">
<div class="column" style="width:19%;">
<div class="fragment">
<ul>
<li>
<code>&amp;</code>:</li>
<li>
<code>|</code>:</li>
<li>
<code>!</code>:</li>
<li>
<code><a href="https://rdrr.io/r/base/Logic.html">xor()</a></code>:</li>
</ul>
</div>
</div><div class="column" style="width:81%;">
<div class="fragment bullet-spacing">
<ul>
<li>
<strong>both</strong> conditions need to hold (AND)<br>
</li>
<li>
<strong>at least one</strong> condition needs to hold (OR)<br>
</li>
<li>
<strong>inverts</strong> a logical condition (<code>TRUE</code> becomes <code>FALSE</code>, vice versa)<br>
</li>
<li>
<strong>exclusive OR</strong> (i.e.&nbsp;x or y but NOT both)</li>
</ul>
</div>
</div>
</div>

<aside><div>
<p>You may also see <code>&amp;&amp;</code> and <code>||</code> but they are what’s known as short-circuiting operators and are not to be used in <code>dplyr</code> functions (used for programming not data manipulation); they’ll only ever return a single <code>TRUE</code> or <code>FALSE</code>.</p>
</div><ol class="aside-footnotes"><li id="fn9"><p>Note: there are TWO equal signs here!</p></li></ol></aside></section><section id="logical-summaries" class="slide level2"><h2>Logical Summaries</h2>
<div class="columns">
<div class="column" style="width:19%;">
<div class="fragment">
<ul>
<li>
<code><a href="https://rdrr.io/r/base/any.html">any()</a></code>:</li>
<li>
<code><a href="https://rdrr.io/r/base/all.html">all()</a></code>:</li>
</ul>
</div>
</div><div class="column" style="width:81%;">
<div class="fragment">
<ul>
<li>the equivalent of <code>|</code>; it’ll return <code>TRUE</code> if there are any <code>TRUE</code>’s in x</li>
<li>the equivalent of <code>&amp;</code>; it’ll return <code>TRUE</code> only if all values of x are <code>TRUE</code>’s</li>
</ul>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-17"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-17-1"><a href="#annotated-cell-17-1"></a>C <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="cn">NA</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="cn">NA</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="1">1</button><span id="annotated-cell-17-2" class="code-annotation-target"><a href="#annotated-cell-17-2"></a><span class="fu">any</span>(C <span class="sc">&lt;=</span> <span class="dv">10</span>)</span>
<span id="annotated-cell-17-3"><a href="#annotated-cell-17-3"></a><span class="fu">all</span>(C <span class="sc">&lt;=</span> <span class="dv">20</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="2">2</button><span id="annotated-cell-17-4" class="code-annotation-target"><a href="#annotated-cell-17-4"></a><span class="fu">all</span>(C <span class="sc">&lt;=</span> <span class="dv">20</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-17" data-target-annotation="3">3</button><span id="annotated-cell-17-5" class="code-annotation-target"><a href="#annotated-cell-17-5"></a><span class="fu">mean</span>(C, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-17" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-lines="2" data-code-cell="annotated-cell-17">Like other summary functions, they’ll return <code>NA</code> if there are any missing values present and it’s <code>FALSE</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-lines="4" data-code-cell="annotated-cell-17">Use <code>na.rm = TRUE</code> to remove <code>NA</code>s prior to evaluation.</span>
</dd>
<dt data-target-cell="annotated-cell-17" data-target-annotation="3">3</dt>
<dd>
<span data-code-annotation="3" data-code-lines="5" data-code-cell="annotated-cell-17">When you evaluate a logical vector numerically, <code>TRUE</code> = 1 and <code>FALSE</code> = 0. This makes <code><a href="https://rdrr.io/r/base/sum.html">sum()</a></code> and <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> useful when summarizing logical functions (sum gives number of <code>TRUE</code>s and mean gives the proportion).</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE
[1] NA
[1] TRUE
[1] 11.25</code></pre>
</div>
</div>
</div>
</section><section id="conditional-transformations" class="slide level2"><h2>Conditional transformations</h2>
<ins>
<strong><code>if_else()</code></strong>
</ins>
<p>If you want to use one value when a condition is <code>TRUE</code> and another value when it’s <code>FALSE</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">if_else</span>(<span class="at">condition =</span> <span class="st">"A logical vector"</span>, </span>
<span id="cb19-2"><a href="#cb19-2"></a>        <span class="at">true =</span> <span class="st">"Output when condition is true"</span>, </span>
<span id="cb19-3"><a href="#cb19-3"></a>        <span class="at">false =</span> <span class="st">"Output when condition is false"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-19"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-19-1"><a href="#annotated-cell-19-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>, <span class="cn">NA</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-19" data-target-annotation="4">4</button><span id="annotated-cell-19-2" class="code-annotation-target"><a href="#annotated-cell-19-2"></a><span class="fu">if_else</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"+ve"</span>, <span class="st">"-ve"</span>, <span class="st">"???"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-19" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-lines="2" data-code-cell="annotated-cell-19">There’s an optional fourth argument, <code>missing</code> which will be used if the input is <code>NA</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "-ve" "-ve" "-ve" "-ve" "+ve" "+ve" "+ve" "???"</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ins>
<strong><code>case_when()</code></strong>
</ins>
<p>A very useful extension of <code>if_else()</code> for multiple conditions<sup>1</sup>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-20"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-20-1"><a href="#annotated-cell-20-1"></a><span class="fu">case_when</span>(</span>
<span id="annotated-cell-20-2"><a href="#annotated-cell-20-2"></a>  x <span class="sc">==</span> <span class="dv">0</span>   <span class="sc">~</span> <span class="st">"0"</span>,</span>
<span id="annotated-cell-20-3"><a href="#annotated-cell-20-3"></a>  x <span class="sc">&lt;</span> <span class="dv">0</span>    <span class="sc">~</span> <span class="st">"-ve"</span>, </span>
<span id="annotated-cell-20-4"><a href="#annotated-cell-20-4"></a>  x <span class="sc">&gt;</span> <span class="dv">0</span>    <span class="sc">~</span> <span class="st">"+ve"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-20" data-target-annotation="5">5</button><span id="annotated-cell-20-5" class="code-annotation-target"><a href="#annotated-cell-20-5"></a>  <span class="fu">is.na</span>(x) <span class="sc">~</span> <span class="st">"???"</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-20" data-target-annotation="6">6</button><span id="annotated-cell-20-6" class="code-annotation-target"><a href="#annotated-cell-20-6"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-20" data-target-annotation="5">5</dt>
<dd>
<span data-code-annotation="5" data-code-lines="5" data-code-cell="annotated-cell-20">Use <code>.default</code> if you want to create a “default”/catch all value.</span>
</dd>
<dt data-target-cell="annotated-cell-20" data-target-annotation="6">6</dt>
<dd>
<span data-code-annotation="6" data-code-lines="6" data-code-cell="annotated-cell-20">Both functions require compatible types: i.e.&nbsp;numerical and logical, strings and factors, dates and datetimes, <code>NA</code> and everything.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "-ve" "-ve" "-ve" "0"   "+ve" "+ve" "+ve" "???"</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn10"><p>Note that if multiple conditions match in <code>case_when()</code>, only the first will be used. </p></li></ol></aside></section></section><section><section id="section-1" class="title-slide slide level1 section-title center" data-menu-title="`dplyr`" data-background-image="images/dplyr.png" data-background-size="contain" data-background-position="center" data-background-color="#B7A57A"><h1></h1>

</section><section id="dplyr" class="slide level2"><h2><code>dplyr</code></h2>
<p>Today, we’ll use tools from the <code>dplyr</code> package to manipulate data!</p>
<ul>
<li>Like <code>ggplot2</code>, <code>dplyr</code> is part of the <em>Tidyverse</em>, and included in the <code>tidyverse</code> package.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>To demonstrate data transformations we’re going to use the <code>nycflights13</code> dataset, which you’ll need to download and load into <code>R</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-22"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-22-1"><a href="#annotated-cell-22-1"></a><span class="co"># Download and load data</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-22" data-target-annotation="7">7</button><span id="annotated-cell-22-2" class="code-annotation-target"><a href="#annotated-cell-22-2"></a><span class="co"># install.packages("nycflights13")</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-22" data-target-annotation="8">8</button><span id="annotated-cell-22-3" class="code-annotation-target"><a href="#annotated-cell-22-3"></a><span class="fu">library</span>(nycflights13)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-22" data-target-annotation="7">7</dt>
<dd>
<span data-code-annotation="7" data-code-lines="2" data-code-cell="annotated-cell-22">Run in console.</span>
</dd>
<dt data-target-cell="annotated-cell-22" data-target-annotation="8">8</dt>
<dd>
<span data-code-annotation="8" data-code-lines="3" data-code-cell="annotated-cell-22">Load into <code>R</code> session.</span>
</dd>
</dl>
</div>
</div>
</div>
<div class="fragment">
<p><code>nycflights13</code> includes five dataframes<sup>1</sup>, some of which contain missing data (<code>NA</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-23"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="9">9</button><span id="annotated-cell-23-1" class="code-annotation-target"><a href="#annotated-cell-23-1"></a><span class="fu">data</span>(flights)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="10">10</button><span id="annotated-cell-23-2" class="code-annotation-target"><a href="#annotated-cell-23-2"></a><span class="fu">data</span>(airlines)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="11">11</button><span id="annotated-cell-23-3" class="code-annotation-target"><a href="#annotated-cell-23-3"></a><span class="fu">data</span>(airports)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="12">12</button><span id="annotated-cell-23-4" class="code-annotation-target"><a href="#annotated-cell-23-4"></a><span class="fu">data</span>(planes)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-23" data-target-annotation="13">13</button><span id="annotated-cell-23-5" class="code-annotation-target"><a href="#annotated-cell-23-5"></a><span class="fu">data</span>(weather)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-23" data-target-annotation="9">9</dt>
<dd>
<span data-code-annotation="9" data-code-lines="1" data-code-cell="annotated-cell-23">flights leaving JFK, LGA, or EWR in 2013</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="10">10</dt>
<dd>
<span data-code-annotation="10" data-code-lines="2" data-code-cell="annotated-cell-23">airline abbreviations</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="11">11</dt>
<dd>
<span data-code-annotation="11" data-code-lines="3" data-code-cell="annotated-cell-23">airport metadata</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="12">12</dt>
<dd>
<span data-code-annotation="12" data-code-lines="4" data-code-cell="annotated-cell-23">airplane metadata</span>
</dd>
<dt data-target-cell="annotated-cell-23" data-target-annotation="13">13</dt>
<dd>
<span data-code-annotation="13" data-code-lines="5" data-code-cell="annotated-cell-23">hourly weather data for JFK, LGA, and EWR</span>
</dd>
</dl>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn11"><p>Note these are separate data frames, each needing to be loaded separately:</p></li></ol></aside></section><section id="dplyr-basics" class="slide level2"><h2>
<code>dplyr</code> Basics</h2>
<p>All <code>dplyr</code> functions have the following in common:</p>
<div>
<ol type="1">
<li class="fragment">The first argument is always a data frame.</li>
<li class="fragment">The subsequent arguments typically describe which columns to operate on, using the variable names (without quotes).</li>
<li class="fragment">The output is always a new data frame.</li>
</ol>
</div>
<div class="fragment">
<p>Each function operates either on rows, columns, groups, or entire tables.</p>
</div>
<div class="fragment">
<p>To save the transformations you’ve made to a data frame you’ll need to save the output to a new object.</p>
</div>
</section></section><section><section id="subsetting-data" class="title-slide slide level1 section-title center" data-background-color="#B7A57A"><h1>Subsetting data</h1>

</section><section id="subset-rows-filter" class="slide level2"><h2>Subset Rows: <code>filter()</code>
</h2>
<p>We often get <em>big</em> datasets, and we only want some of the entries. We can subset rows using <code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-24"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-24-1"><a href="#annotated-cell-24-1"></a>delay_2hr <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="14">14</button><span id="annotated-cell-24-2" class="code-annotation-target"><a href="#annotated-cell-24-2"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">&gt;</span> <span class="dv">120</span>)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-24" data-target-annotation="15">15</button><span id="annotated-cell-24-3" class="code-annotation-target"><a href="#annotated-cell-24-3"></a>delay_2hr</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-24" data-target-annotation="14">14</dt>
<dd>
<span data-code-annotation="14" data-code-lines="2" data-code-cell="annotated-cell-24">Here’s where we’ll use a lot of logical operators. Make sure to use <code>==</code> not <code>=</code> to test the logical condition.</span>
</dd>
<dt data-target-cell="annotated-cell-24" data-target-annotation="15">15</dt>
<dd>
<span data-code-annotation="15" data-code-lines="3" data-code-cell="annotated-cell-24">Now, <code>delay_2hr</code> is an object in our environment which contains rows corresponding to flights that experienced at least a 2 hour delay.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,723 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      848           1835       853     1001           1950
 2  2013     1     1      957            733       144     1056            853
 3  2013     1     1     1114            900       134     1447           1222
 4  2013     1     1     1540           1338       122     2020           1825
 5  2013     1     1     1815           1325       290     2120           1542
 6  2013     1     1     1842           1422       260     1958           1535
 7  2013     1     1     1856           1645       131     2212           2005
 8  2013     1     1     1934           1725       129     2126           1855
 9  2013     1     1     1938           1703       155     2109           1823
10  2013     1     1     1942           1705       157     2124           1830
# ℹ 9,713 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</section><section id="subset-columns-select" class="slide level2"><h2>Subset Columns: <code>select()</code>
</h2>
<p>What if we want to keep every observation, but only use certain variables? Use <code>select()</code>!</p>
<div class="fragment">
<p>We can select columns by name:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-25"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-25-1"><a href="#annotated-cell-25-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-25" data-target-annotation="16">16</button><span id="annotated-cell-25-2" class="code-annotation-target"><a href="#annotated-cell-25-2"></a>  <span class="fu">select</span>(year, month, day)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-25" data-target-annotation="16">16</dt>
<dd>
<span data-code-annotation="16" data-code-lines="2" data-code-cell="annotated-cell-25">You can use a <code>-</code> before a variable name or a vector of variables to drop them from the data (i.e.&nbsp;<br><code>select(-c(year, month, day))</code>).</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
    year month   day
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1
 2  2013     1     1
 3  2013     1     1
 4  2013     1     1
 5  2013     1     1
 6  2013     1     1
 7  2013     1     1
 8  2013     1     1
 9  2013     1     1
10  2013     1     1
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</div>
</section><section id="subset-columns-select-1" class="slide level2"><h2>Subset Columns: <code>select()</code>
</h2>
<p>What if we want to keep every observation, but only use certain variables? Use <code>select()</code>!</p>
<p>We can select columns between variables (inclusive):</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-26"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-26-1"><a href="#annotated-cell-26-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-26" data-target-annotation="17">17</button><span id="annotated-cell-26-2" class="code-annotation-target"><a href="#annotated-cell-26-2"></a>  <span class="fu">select</span>(year<span class="sc">:</span>day)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-26" data-target-annotation="17">17</dt>
<dd>
<span data-code-annotation="17" data-code-lines="2" data-code-cell="annotated-cell-26">Add a <code>!</code> before <code>year</code> and you’ll drop this group of variables from the data.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 3
    year month   day
   &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2013     1     1
 2  2013     1     1
 3  2013     1     1
 4  2013     1     1
 5  2013     1     1
 6  2013     1     1
 7  2013     1     1
 8  2013     1     1
 9  2013     1     1
10  2013     1     1
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</section><section id="subset-columns-select-2" class="slide level2"><h2>Subset Columns: <code>select()</code>
</h2>
<p>What if we want to keep every observation, but only use certain variables? Use <code>select()</code>!</p>
<p>We can select columns based on a condition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-27"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-27-1"><a href="#annotated-cell-27-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-27" data-target-annotation="18">18</button><span id="annotated-cell-27-2" class="code-annotation-target"><a href="#annotated-cell-27-2"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-27" data-target-annotation="18">18</dt>
<dd>
<span data-code-annotation="18" data-code-lines="2" data-code-cell="annotated-cell-27">There are a number of helper functions you can use with <code>select()</code> including <code>starts_with()</code>, <code>ends_with()</code>, <code>contains()</code> and <code>num_range()</code>. Read more about these and more <a href="https://tidyselect.r-lib.org/reference/index.html">here</a>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 4
   carrier tailnum origin dest 
   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;
 1 UA      N14228  EWR    IAH  
 2 UA      N24211  LGA    IAH  
 3 AA      N619AA  JFK    MIA  
 4 B6      N804JB  JFK    BQN  
 5 DL      N668DN  LGA    ATL  
 6 UA      N39463  EWR    ORD  
 7 B6      N516JB  EWR    FLL  
 8 EV      N829AS  LGA    IAD  
 9 B6      N593JB  JFK    MCO  
10 AA      N3ALAA  LGA    ORD  
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</section><section id="finding-unique-rows-distinct" class="slide level2"><h2>Finding Unique Rows: <code>distinct()</code>
</h2>
<p>You may want to find the unique combinations of variables in a dataset. Use <code>distinct()</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-28"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-28-1"><a href="#annotated-cell-28-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-28" data-target-annotation="19">19</button><span id="annotated-cell-28-2" class="code-annotation-target"><a href="#annotated-cell-28-2"></a>  <span class="fu">distinct</span>(origin, dest)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-28" data-target-annotation="19">19</dt>
<dd>
<span data-code-annotation="19" data-code-lines="2" data-code-cell="annotated-cell-28">Find all unique origin and destination pairs.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 224 × 2
   origin dest 
   &lt;chr&gt;  &lt;chr&gt;
 1 EWR    IAH  
 2 LGA    IAH  
 3 JFK    MIA  
 4 JFK    BQN  
 5 LGA    ATL  
 6 EWR    ORD  
 7 EWR    FLL  
 8 LGA    IAD  
 9 JFK    MCO  
10 LGA    ORD  
# ℹ 214 more rows</code></pre>
</div>
</div>
</div>
</section><section id="distinct-drops-variables" class="slide level2"><h2>
<code>distinct()</code> drops variables!</h2>
<p>By default, <code>distinct()</code> drops unused variables. If you don’t want to drop them, add the argument <code>.keep_all = TRUE</code>:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-29"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-29-1"><a href="#annotated-cell-29-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-29" data-target-annotation="20">20</button><span id="annotated-cell-29-2" class="code-annotation-target"><a href="#annotated-cell-29-2"></a>  <span class="fu">distinct</span>(origin, dest, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-29" data-target-annotation="20">20</dt>
<dd>
<span data-code-annotation="20" data-code-lines="2" data-code-cell="annotated-cell-29">It’s not a coincidence that all of these distinct flights are on January 1: <code>distinct()</code> will find the first occurrence of a unique row in the dataset and discard the rest. Use <code>count()</code> if you’re looking for the number of occurrences.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 224 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 214 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</section><section id="count-unique-rows-count" class="slide level2"><h2>Count Unique Rows: <code>count()</code>
</h2>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-30"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-30-1"><a href="#annotated-cell-30-1"></a>flights <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-30" data-target-annotation="21">21</button><span id="annotated-cell-30-2" class="code-annotation-target"><a href="#annotated-cell-30-2"></a>  <span class="fu">count</span>(origin, dest, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-30" data-target-annotation="21">21</dt>
<dd>
<span data-code-annotation="21" data-code-lines="2" data-code-cell="annotated-cell-30"><code>sort = TRUE</code> arranges them in descending order of number of occurrences.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 224 × 3
   origin dest      n
   &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;
 1 JFK    LAX   11262
 2 LGA    ATL   10263
 3 LGA    ORD    8857
 4 JFK    SFO    8204
 5 LGA    CLT    6168
 6 EWR    ORD    6100
 7 JFK    BOS    5898
 8 LGA    MIA    5781
 9 JFK    MCO    5464
10 EWR    BOS    5327
# ℹ 214 more rows</code></pre>
</div>
</div>
</div>
</section></section><section><section id="modifying-data" class="title-slide slide level1 section-title center" data-background-color="#B7A57A"><h1>Modifying data</h1>

</section><section id="sorting-data-by-rows-arrange" class="slide level2"><h2>Sorting Data by Rows: <code>arrange()</code>
</h2>
<p>Sometimes it’s useful to sort rows in your data, in ascending (low to high) or descending (high to low) order. We do that with <code>arrange()</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-31"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-31-1"><a href="#annotated-cell-31-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="22">22</button><span id="annotated-cell-31-2" class="code-annotation-target"><a href="#annotated-cell-31-2"></a>  <span class="fu">arrange</span>(year, month, day, dep_time)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-31" data-target-annotation="22">22</dt>
<dd>
<span data-code-annotation="22" data-code-lines="2" data-code-cell="annotated-cell-31">If you provide more than one column name, each additional column will be used to break ties in the values of preceding columns.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</section><section id="sorting-data-by-rows-arrange-1" class="slide level2"><h2>Sorting Data by Rows: <code>arrange()</code>
</h2>
<p>To sort in descending order, using <code>desc()</code> within <code>arrange()</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     9      641            900      1301     1242           1530
 2  2013     6    15     1432           1935      1137     1607           2120
 3  2013     1    10     1121           1635      1126     1239           1810
 4  2013     9    20     1139           1845      1014     1457           2210
 5  2013     7    22      845           1600      1005     1044           1815
 6  2013     4    10     1100           1900       960     1342           2211
 7  2013     3    17     2321            810       911      135           1020
 8  2013     6    27      959           1900       899     1236           2226
 9  2013     7    22     2257            759       898      121           1026
10  2013    12     5      756           1700       896     1058           2020
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</section><section id="rename-variables-rename" class="slide level2"><h2>Rename Variables: <code>rename()</code>
</h2>
<p>You may receive data with unintuitive variable names. Change them using <code>rename()</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-33"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-33-1"><a href="#annotated-cell-33-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-33" data-target-annotation="23">23</button><span id="annotated-cell-33-2" class="code-annotation-target"><a href="#annotated-cell-33-2"></a>  <span class="fu">rename</span>(<span class="at">tail_num =</span> tailnum)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-33" data-target-annotation="23">23</dt>
<dd>
<span data-code-annotation="23" data-code-lines="2" data-code-cell="annotated-cell-33"><code>rename(new_name = old_name)</code> is the format. Reminder to use <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code> if you want to automate this process for a lot of variables.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tail_num &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-caution no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:tomato"><i class="fa-solid fa-exclamation-triangle" aria-label="exclamation-triangle"></i></span> Variable Syntax</strong></p>
</div>
<div class="callout-content">
<p>I recommend <strong>against</strong> using spaces in a name! It makes things <em>really hard</em> sometimes!!</p>
</div>
</div>
</div>
</div>
</section><section id="create-new-columns-mutate" class="slide level2"><h2>Create New Columns: <code>mutate()</code>
</h2>
<p>You can add new columns to a data frame using <code>mutate()</code>.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-34"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-34-1"><a href="#annotated-cell-34-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-34-2"><a href="#annotated-cell-34-2"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-34-3"><a href="#annotated-cell-34-3"></a>    <span class="at">gain =</span> dep_delay <span class="sc">-</span> arr_delay,</span>
<span id="annotated-cell-34-4"><a href="#annotated-cell-34-4"></a>    <span class="at">speed =</span> distance <span class="sc">/</span> air_time <span class="sc">*</span> <span class="dv">60</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-34" data-target-annotation="24">24</button><span id="annotated-cell-34-5" class="code-annotation-target"><a href="#annotated-cell-34-5"></a>    <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="annotated-cell-34-6"><a href="#annotated-cell-34-6"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-34" data-target-annotation="24">24</dt>
<dd>
<span data-code-annotation="24" data-code-lines="5" data-code-cell="annotated-cell-34">By default, <code>mutate()</code> adds new columns on the right hand side of your dataset, which makes it difficult to see if anything happened. You can use the <code>.before</code> argument to specify which numeric index (or variable name) to move the newly created variable to. <code>.after</code> is an alternative argument for this.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 21
    gain speed  year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1    -9  370.  2013     1     1      517            515         2      830
 2   -16  374.  2013     1     1      533            529         4      850
 3   -31  408.  2013     1     1      542            540         2      923
 4    17  517.  2013     1     1      544            545        -1     1004
 5    19  394.  2013     1     1      554            600        -6      812
 6   -16  288.  2013     1     1      554            558        -4      740
 7   -24  404.  2013     1     1      555            600        -5      913
 8    11  259.  2013     1     1      557            600        -3      709
 9     5  405.  2013     1     1      557            600        -3      838
10   -10  319.  2013     1     1      558            600        -2      753
# ℹ 336,766 more rows
# ℹ 12 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
#   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</section><section id="specifying-variables-to-keep-mutate" class="slide level2"><h2>Specifying Variables to Keep: <code>mutate()</code>
</h2>
<p>You can specify which columns to keep with the <code>.keep</code> argument:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-35"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-35-1"><a href="#annotated-cell-35-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-35-2"><a href="#annotated-cell-35-2"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-35-3"><a href="#annotated-cell-35-3"></a>    <span class="at">gain =</span> dep_delay <span class="sc">-</span> arr_delay,</span>
<span id="annotated-cell-35-4"><a href="#annotated-cell-35-4"></a>    <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="annotated-cell-35-5"><a href="#annotated-cell-35-5"></a>    <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-35" data-target-annotation="25">25</button><span id="annotated-cell-35-6" class="code-annotation-target"><a href="#annotated-cell-35-6"></a>    <span class="at">.keep =</span> <span class="st">"used"</span></span>
<span id="annotated-cell-35-7"><a href="#annotated-cell-35-7"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-35" data-target-annotation="25">25</dt>
<dd>
<span data-code-annotation="25" data-code-lines="6" data-code-cell="annotated-cell-35">“used” retains only the variables used to create the new variables, which is useful for checking your work. Other options include: “all,” “unused,” and “none.”</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 6
   dep_delay arr_delay air_time  gain hours gain_per_hour
       &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
 1         2        11      227    -9 3.78          -2.38
 2         4        20      227   -16 3.78          -4.23
 3         2        33      160   -31 2.67         -11.6 
 4        -1       -18      183    17 3.05           5.57
 5        -6       -25      116    19 1.93           9.83
 6        -4        12      150   -16 2.5           -6.4 
 7        -5        19      158   -24 2.63          -9.11
 8        -3       -14       53    11 0.883         12.5 
 9        -3        -8      140     5 2.33           2.14
10        -2         8      138   -10 2.3           -4.35
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</section><section id="move-variables-around-relocate" class="slide level2"><h2>Move Variables Around: <code>relocate()</code>
</h2>
<p>You might want to collect related variables together or move important variables to the front. Use <code>relocate()</code>!</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-36"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-36-1"><a href="#annotated-cell-36-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-36" data-target-annotation="26">26</button><span id="annotated-cell-36-2" class="code-annotation-target"><a href="#annotated-cell-36-2"></a>  <span class="fu">relocate</span>(time_hour, air_time)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-36" data-target-annotation="26">26</dt>
<dd>
<span data-code-annotation="26" data-code-lines="2" data-code-cell="annotated-cell-36">By default <code>relocate()</code> moves variables to the front but you can also specify where to put them using the <code>.before</code> and <code>.after</code> arguments, just like in <code>mutate()</code>.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
   time_hour           air_time  year month   day dep_time sched_dep_time
   &lt;dttm&gt;                 &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;
 1 2013-01-01 05:00:00      227  2013     1     1      517            515
 2 2013-01-01 05:00:00      227  2013     1     1      533            529
 3 2013-01-01 05:00:00      160  2013     1     1      542            540
 4 2013-01-01 05:00:00      183  2013     1     1      544            545
 5 2013-01-01 06:00:00      116  2013     1     1      554            600
 6 2013-01-01 05:00:00      150  2013     1     1      554            558
 7 2013-01-01 06:00:00      158  2013     1     1      555            600
 8 2013-01-01 06:00:00       53  2013     1     1      557            600
 9 2013-01-01 06:00:00      140  2013     1     1      557            600
10 2013-01-01 06:00:00      138  2013     1     1      558            600
# ℹ 336,766 more rows
# ℹ 12 more variables: dep_delay &lt;dbl&gt;, arr_time &lt;int&gt;, sched_arr_time &lt;int&gt;,
#   arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;,
#   dest &lt;chr&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;</code></pre>
</div>
</div>
</section></section><section><section id="summarizing-data" class="title-slide slide level1 section-title center" data-background-color="#B7A57A"><h1>Summarizing data</h1>

</section><section id="grouping-data-group_by" class="slide level2"><h2>Grouping Data: <code>group_by()</code>
</h2>
<p>If you want to analyze your data by specific groupings, use <code>group_by()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-37"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-37-1"><a href="#annotated-cell-37-1"></a>flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-37" data-target-annotation="27">27</button><span id="annotated-cell-37-2" class="code-annotation-target"><a href="#annotated-cell-37-2"></a>  <span class="fu">group_by</span>(month)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-37" data-target-annotation="27">27</dt>
<dd>
<span data-code-annotation="27" data-code-lines="2" data-code-cell="annotated-cell-37"><code>group_by()</code> doesn’t change the data but you’ll notice that the output indicates that it is “grouped by” month <code>(Groups: month [12])</code>. This means subsequent operations will now work “by month”.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
# Groups:   month [12]
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</section><section id="summarizing-data-summarize" class="slide level2"><h2>Summarizing Data: <code>summarize()</code>
</h2>
<p><strong><code>summarize()</code></strong> calculates summaries of variables in your data:</p>
<div>
<ul>
<li class="fragment">Count the number of rows</li>
<li class="fragment">Calculate the mean</li>
<li class="fragment">Calculate the sum</li>
<li class="fragment">Find the minimum or maximum value</li>
</ul>
</div>
<div class="fragment">
<p>You can use any function inside <code>summarize()</code> that aggregates <em>multiple values</em> into a <em>single value</em> (like <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>, <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>, or <code><a href="https://rdrr.io/r/base/Extremes.html">max()</a></code>).</p>
</div>
</section><section id="summarize-example" class="slide level2"><h2>
<code>summarize()</code> Example</h2>
<p>Let’s see what this looks like in our flights dataset:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-38"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-38-1"><a href="#annotated-cell-38-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-38-2"><a href="#annotated-cell-38-2"></a>  <span class="fu">summarize</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-38" data-target-annotation="28">28</button><span id="annotated-cell-38-3" class="code-annotation-target"><a href="#annotated-cell-38-3"></a>    <span class="at">avg_delay =</span> <span class="fu">mean</span>(dep_delay)</span>
<span id="annotated-cell-38-4"><a href="#annotated-cell-38-4"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-38" data-target-annotation="28">28</dt>
<dd>
<span data-code-annotation="28" data-code-lines="3" data-code-cell="annotated-cell-38">The <code>NA</code> produced here is a result of calling <code>mean</code> on <code>dep_delay</code>. Any summarizing function will return <code>NA</code> if <strong>any</strong> of the values are <code>NA</code>. We can set <code>na.rm = TRUE</code> to change this behavior.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  avg_delay
      &lt;dbl&gt;
1        NA</code></pre>
</div>
</div>
</div>
</section><section id="summarize-example-1" class="slide level2"><h2>
<code>summarize()</code> Example</h2>
<p>Let’s see what this looks like in our flights dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">summarize</span>(</span>
<span id="cb39-3"><a href="#cb39-3"></a>    <span class="at">avg_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) </span>
<span id="cb39-4"><a href="#cb39-4"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  avg_delay
      &lt;dbl&gt;
1      12.6</code></pre>
</div>
</div>
</section><section id="summarizing-data-by-groups" class="slide level2"><h2>Summarizing Data by Groups</h2>
<p>What if we want to summarize data by our groups? Use <code>group_by()</code> <strong>and</strong> <code>summarize()</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> </span>
<span id="cb41-3"><a href="#cb41-3"></a>  <span class="fu">summarize</span>(</span>
<span id="cb41-4"><a href="#cb41-4"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-5"><a href="#cb41-5"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   month delay
   &lt;int&gt; &lt;dbl&gt;
 1     1 10.0 
 2     2 10.8 
 3     3 13.2 
 4     4 13.9 
 5     5 13.0 
 6     6 20.8 
 7     7 21.7 
 8     8 12.6 
 9     9  6.72
10    10  6.24
11    11  5.44
12    12 16.6 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Because we did <code>group_by()</code> with <code>month</code>, then used <code>summarize()</code>, we get <em>one row per value of <code>month</code></em>!</p>
</div>
</section><section id="summarizing-data-by-groups-1" class="slide level2"><h2>Summarizing Data by Groups</h2>
<p>You can create any number of summaries in a single call to summarize().</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-41"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-41-1"><a href="#annotated-cell-41-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-41-2"><a href="#annotated-cell-41-2"></a>  <span class="fu">group_by</span>(month) <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-41-3"><a href="#annotated-cell-41-3"></a>  <span class="fu">summarize</span>(</span>
<span id="annotated-cell-41-4"><a href="#annotated-cell-41-4"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-41" data-target-annotation="29">29</button><span id="annotated-cell-41-5" class="code-annotation-target"><a href="#annotated-cell-41-5"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="annotated-cell-41-6"><a href="#annotated-cell-41-6"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-41" data-target-annotation="29">29</dt>
<dd>
<span data-code-annotation="29" data-code-lines="5" data-code-cell="annotated-cell-41"><code>n()</code> returns the number of rows in each group.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   month delay     n
   &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
 1     1 10.0  27004
 2     2 10.8  24951
 3     3 13.2  28834
 4     4 13.9  28330
 5     5 13.0  28796
 6     6 20.8  28243
 7     7 21.7  29425
 8     8 12.6  29327
 9     9  6.72 27574
10    10  6.24 28889
11    11  5.44 27268
12    12 16.6  28135</code></pre>
</div>
</div>
</section><section id="grouping-by-multiple-variables-fa-scroll" class="slide level2 scrollable"><h2>Grouping by Multiple Variables <span style="color:#B7A57A"><i class="fa-solid fa-scroll" aria-label="scroll"></i></span>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>daily <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2"></a>  <span class="fu">group_by</span>(year, month, day)  </span>
<span id="cb44-3"><a href="#cb44-3"></a>daily</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
# Groups:   year, month, day [365]
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:green"><i class="fa-solid fa-info-circle" aria-label="info-circle"></i></span> Summary &amp; Grouping Behavior</strong></p>
</div>
<div class="callout-content">
<p>When you summarize a tibble grouped by more than one variable, each summary peels off the last group. You can change the default behavior by setting the <code>.groups</code> argument to a different value, e.g., “drop” to drop all grouping or “keep” to preserve the same groups. The default is “drop_last”.</p>
</div>
</div>
</div>
</div>
</section><section id="remove-grouping-ungroup" class="slide level2"><h2>Remove Grouping: <code>ungroup()</code>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>daily <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="fu">ungroup</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</section><section id="new-alternative-for-grouping-.by" class="slide level2"><h2>New Alternative for Grouping: <code>.by</code>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-44"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-44-1"><a href="#annotated-cell-44-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-44-2"><a href="#annotated-cell-44-2"></a>  <span class="fu">summarize</span>(</span>
<span id="annotated-cell-44-3"><a href="#annotated-cell-44-3"></a>    <span class="at">delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="annotated-cell-44-4"><a href="#annotated-cell-44-4"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-44" data-target-annotation="30">30</button><span id="annotated-cell-44-5" class="code-annotation-target"><a href="#annotated-cell-44-5"></a>    <span class="at">.by =</span> month</span>
<span id="annotated-cell-44-6"><a href="#annotated-cell-44-6"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-44" data-target-annotation="30">30</dt>
<dd>
<span data-code-annotation="30" data-code-lines="5" data-code-cell="annotated-cell-44"><code>.by</code> works with all verbs and has the advantage that you don’t need to use the <code>.groups</code> argument to suppress the grouping message or <code>ungroup()</code> when you’re done.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   month delay     n
   &lt;int&gt; &lt;dbl&gt; &lt;int&gt;
 1     1 10.0  27004
 2    10  6.24 28889
 3    11  5.44 27268
 4    12 16.6  28135
 5     2 10.8  24951
 6     3 13.2  28834
 7     4 13.9  28330
 8     5 13.0  28796
 9     6 20.8  28243
10     7 21.7  29425
11     8 12.6  29327
12     9  6.72 27574</code></pre>
</div>
</div>
</section><section id="select-specific-rows-per-group-slice_" class="slide level2"><h2>Select Specific Rows Per Group: <code>slice_*</code>
</h2>
<p>There are five handy functions that allow you extract specific rows within each group:</p>
<div>
<ul>
<li class="fragment">
<code>df |&gt; slice_head(n = 1)</code> takes the first row from each group.</li>
<li class="fragment">
<code>df |&gt; slice_tail(n = 1)</code> takes the last row in each group.</li>
<li class="fragment">
<code>df |&gt; slice_min(x, n = 1)</code> takes the row with the smallest value of column x.</li>
<li class="fragment">
<code>df |&gt; slice_max(x, n = 1)</code> takes the row with the largest value of column x.</li>
<li class="fragment">
<code>df |&gt; slice_sample(n = 1)</code> takes one random row.</li>
</ul>
</div>
<div class="fragment">
<p>Let’s find the flights that are most delayed upon arrival at each destination.</p>
</div>
</section><section id="select-specific-rows-per-group-slice_-1" class="slide level2"><h2>Select Specific Rows Per Group: <code>slice_*</code>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-45"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-45-1"><a href="#annotated-cell-45-1"></a>flights <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-45-2"><a href="#annotated-cell-45-2"></a>  <span class="fu">group_by</span>(dest) <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-45" data-target-annotation="31">31</button><span id="annotated-cell-45-3" class="code-annotation-target"><a href="#annotated-cell-45-3"></a>  <span class="fu">slice_max</span>(arr_delay, <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-45-4"><a href="#annotated-cell-45-4"></a>  <span class="fu">relocate</span>(dest) </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-45" data-target-annotation="31">31</dt>
<dd>
<span data-code-annotation="31" data-code-lines="3" data-code-cell="annotated-cell-45">You can vary <code>n</code> to select more than one row, or instead of <code>n =</code>, you can use <code>prop = 0.1</code> to select (e.g.) 10% of the rows in each group.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 108 × 19
# Groups:   dest [105]
   dest   year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1 ABQ    2013     7    22     2145           2007        98      132
 2 ACK    2013     7    23     1139            800       219     1250
 3 ALB    2013     1    25      123           2000       323      229
 4 ANC    2013     8    17     1740           1625        75     2042
 5 ATL    2013     7    22     2257            759       898      121
 6 AUS    2013     7    10     2056           1505       351     2347
 7 AVL    2013     8    13     1156            832       204     1417
 8 BDL    2013     2    21     1728           1316       252     1839
 9 BGR    2013    12     1     1504           1056       248     1628
10 BHM    2013     4    10       25           1900       325      136
# ℹ 98 more rows
# ℹ 11 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
#   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>

<aside><div>
<p>There are 105 groups but 108 rows! Why? <code>slice_min()</code> and <code>slice_max()</code> keep tied values so <code>n = 1</code> means “give us all rows with the highest value.” If you want exactly one row per group you can set <code>with_ties = FALSE</code>.</p>
</div></aside></section></section><section><section id="merging-data" class="title-slide slide level1 section-title center" data-background-color="#4B2E83"><h1>Merging Data</h1>

</section><section id="why-merge-data" class="slide level2"><h2>Why Merge Data?</h2>
<p>In practice, we often collect data from different sources. To analyze the data, we usually must first combine (merge) them.</p>
<div class="fragment">
<p>For example, imagine you would like to study county-level patterns with respect to age and grocery spending. However, you can only find,</p>
<ul>
<li>County level age data from the US Census, and</li>
<li>County level grocery spending data from the US Department of Agriculture</li>
</ul>
</div>
<div class="fragment">
<p>Merge the data!!</p>
</div>
<div class="fragment">
<p>To do this we’ll be using the various <strong>join</strong> functions from the <code>dplyr</code> package.</p>
</div>
</section><section id="joining-in-concept" class="slide level2"><h2>Joining in Concept</h2>
<p>We need to think about the following when we want to merge data frames A and B:</p>
<div class="fragment">
<ul>
<li>Which rows are we keeping from each data frame?</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>Which columns are we keeping from each data frame?</li>
</ul>
</div>
<div class="fragment fade-in">
<div class="fragment highlight-red">
<ul>
<li>Which variables determine whether rows match?</li>
</ul>
</div>
</div>
</section><section id="keys" class="slide level2"><h2>Keys</h2>
<p>Keys are the way that two datasets are connected to one another. The two types of keys are:</p>
<div>
<ol type="1">
<li class="fragment">
<strong>Primary</strong>: a variable or set of variables that uniquely identifies each observation.
<ol type="i">
<li class="fragment">When more than one variable makes up the primary key it’s called a <strong>compound key</strong>
</li>
</ol>
</li>
<li class="fragment">
<strong>Foreign</strong>: a variable (or set of variables) that corresponds to a primary key in another table.</li>
</ol>
</div>
</section><section id="primary-keys-fa-scroll" class="slide level2 scrollable"><h2>Primary Keys <span style="color:#B7A57A"><i class="fa-solid fa-scroll" aria-label="scroll"></i></span>
</h2>
<p>Let’s look at our data to gain a better sense of what this all means.</p>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby">
<li><a data-tabby-default="" href="#tabset-3-1"><code>airlines</code></a></li>
<li><a href="#tabset-3-2"><code>airports</code></a></li>
<li><a href="#tabset-3-3"><code>planes</code></a></li>
<li><a href="#tabset-3-4"><code>weather</code></a></li>
<li><a href="#tabset-3-5"><code>flights</code></a></li>
</ul>
<div class="tab-content">
<div id="tabset-3-1">
<div class="smaller-font">
<p><code>airlines</code> records two pieces of data about each airline: its carrier code and its full name. You can identify an airline with its two letter carrier code, making <code>carrier</code> the primary key.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>airlines </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 16 × 2
   carrier name                       
   &lt;chr&gt;   &lt;chr&gt;                      
 1 9E      Endeavor Air Inc.          
 2 AA      American Airlines Inc.     
 3 AS      Alaska Airlines Inc.       
 4 B6      JetBlue Airways            
 5 DL      Delta Air Lines Inc.       
 6 EV      ExpressJet Airlines Inc.   
 7 F9      Frontier Airlines Inc.     
 8 FL      AirTran Airways Corporation
 9 HA      Hawaiian Airlines Inc.     
10 MQ      Envoy Air                  
11 OO      SkyWest Airlines Inc.      
12 UA      United Air Lines Inc.      
13 US      US Airways Inc.            
14 VX      Virgin America             
15 WN      Southwest Airlines Co.     
16 YV      Mesa Airlines Inc.         </code></pre>
</div>
</div>
</div>
<div id="tabset-3-2">
<div class="smaller-font">
<p><code>airports</code> records data about each airport. You can identify each airport by its three letter airport code, making <code>faa</code> the primary key.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>airports</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,458 × 8
   faa   name                             lat    lon   alt    tz dst   tzone    
   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
 1 04G   Lansdowne Airport               41.1  -80.6  1044    -5 A     America/…
 2 06A   Moton Field Municipal Airport   32.5  -85.7   264    -6 A     America/…
 3 06C   Schaumburg Regional             42.0  -88.1   801    -6 A     America/…
 4 06N   Randall Airport                 41.4  -74.4   523    -5 A     America/…
 5 09J   Jekyll Island Airport           31.1  -81.4    11    -5 A     America/…
 6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593    -5 A     America/…
 7 0G6   Williams County Airport         41.5  -84.5   730    -5 A     America/…
 8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492    -5 A     America/…
 9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000    -5 U     America/…
10 0S9   Jefferson County Intl           48.1 -123.    108    -8 A     America/…
# ℹ 1,448 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3">
<div class="smaller-font">
<p><code>planes</code> records data about each plane. You can identify a plane by its tail number, making <code>tailnum</code> the primary key.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>planes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,322 × 9
   tailnum  year type              manufacturer model engines seats speed engine
   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; 
 1 N10156   2004 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
 2 N102UW   1998 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 3 N103US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 4 N104UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 5 N10575   2002 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
 6 N105UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 7 N107US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 8 N108UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
 9 N109UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
10 N110UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
# ℹ 3,312 more rows</code></pre>
</div>
</div>
</div>
<div id="tabset-3-4">
<div class="smaller-font">
<p><code>weather</code> records data about the weather at the origin airports. You can identify each observation by the combination of location and time, making <code>origin</code> and <code>time_hour</code> the compound primary key.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>weather</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 26,115 × 15
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
   &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
# ℹ 26,105 more rows
# ℹ 5 more variables: wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;, pressure &lt;dbl&gt;,
#   visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5">
<div class="smaller-font">
<p><code>flights</code> actually contains <strong>foreign keys</strong> that correspond to the primary keys of the other datasets.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>flights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 19
    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
 1  2013     1     1      517            515         2      830            819
 2  2013     1     1      533            529         4      850            830
 3  2013     1     1      542            540         2      923            850
 4  2013     1     1      544            545        -1     1004           1022
 5  2013     1     1      554            600        -6      812            837
 6  2013     1     1      554            558        -4      740            728
 7  2013     1     1      555            600        -5      913            854
 8  2013     1     1      557            600        -3      709            723
 9  2013     1     1      557            600        -3      838            846
10  2013     1     1      558            600        -2      753            745
# ℹ 336,766 more rows
# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="foreign-keys" class="slide level2"><h2>Foreign Keys</h2>

<img data-src="images/relational.png" class="r-stretch quarto-figure-center"><p class="caption">Note: grey shading indicates the primary key for that particular dataset.</p><div>
<ul>
<li class="fragment">
<code>flights$origin</code> –&gt; <code>airports$faa</code>
</li>
<li class="fragment">
<code>flights$dest</code> –&gt; <code>airports$faa</code>
</li>
<li class="fragment">
<code>flights$origin</code>-<code>flights$time_hour</code> –&gt; <code>weather$origin</code>-<code>weather$time_hour</code>.</li>
<li class="fragment">
<code>flights$tailnum</code> –&gt; <code>planes$tailnum</code>
</li>
<li class="fragment">
<code>flights$carrier</code> –&gt; <code>airlines$carrier</code>
</li>
</ul>
</div>
</section><section id="checking-keys" class="slide level2"><h2>Checking Keys</h2>
<p>A nice feature of these data are that the primary and foreign keys have the same name and almost every variable name used across multiple tables has the same meaning.<sup>1</sup> This isn’t always the case!<sup>2</sup></p>
<div class="fragment">
<p>It is good practice to make sure your primary keys actually uniquely identify an observation and that they don’t have any missing values.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-46"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-46-1"><a href="#annotated-cell-46-1"></a>planes <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-46" data-target-annotation="1">1</button><span id="annotated-cell-46-2" class="code-annotation-target"><a href="#annotated-cell-46-2"></a>  <span class="fu">count</span>(tailnum) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-46-3"><a href="#annotated-cell-46-3"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">1</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-46" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-lines="2,3" data-code-cell="annotated-cell-46">If your primary keys uniquely identify each observation you’ll get an empty tibble in return.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 2
# ℹ 2 variables: tailnum &lt;chr&gt;, n &lt;int&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-47"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-47-1"><a href="#annotated-cell-47-1"></a>planes <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-47" data-target-annotation="2">2</button><span id="annotated-cell-47-2" class="code-annotation-target"><a href="#annotated-cell-47-2"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(tailnum))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-47" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-lines="2" data-code-cell="annotated-cell-47">If none of your primary keys are missing you’ll get an empty tibble in return here too.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 9
# ℹ 9 variables: tailnum &lt;chr&gt;, year &lt;int&gt;, type &lt;chr&gt;, manufacturer &lt;chr&gt;,
#   model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<aside><ol class="aside-footnotes"><li id="fn12"><p>With the exception of <code>year</code>: it means year of departure in <code>flights</code> and year of manufacture in <code>planes</code>. </p></li><li id="fn13"><p>We’ll cover how to handle this shortly.</p></li></ol></aside></section><section id="surrogate-keys" class="slide level2"><h2>Surrogate Keys</h2>
<p>Sometimes you’ll want to create an index of your observations to serve as a surrogate key because the compound primary key is not particlarly easy to reference.</p>
<div class="fragment">
<p>For example, our <code>flights</code> dataset has three variables that uniquely identify each observation: <code>time_hour</code>, <code>carrier</code>, <code>flight</code>.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-48"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-48-1"><a href="#annotated-cell-48-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-48" data-target-annotation="3">3</button><span id="annotated-cell-48-2" class="code-annotation-target"><a href="#annotated-cell-48-2"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">row_number</span>(), <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="annotated-cell-48-3"><a href="#annotated-cell-48-3"></a>flights2</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-48" data-target-annotation="3">3</dt>
<dd>
<span data-code-annotation="3" data-code-lines="2" data-code-cell="annotated-cell-48"><code>row_number()</code> simply specifies the row number of the dataframe.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 20
      id  year month   day dep_time sched_dep_time dep_delay arr_time
   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;
 1     1  2013     1     1      517            515         2      830
 2     2  2013     1     1      533            529         4      850
 3     3  2013     1     1      542            540         2      923
 4     4  2013     1     1      544            545        -1     1004
 5     5  2013     1     1      554            600        -6      812
 6     6  2013     1     1      554            558        -4      740
 7     7  2013     1     1      555            600        -5      913
 8     8  2013     1     1      557            600        -3      709
 9     9  2013     1     1      557            600        -3      838
10    10  2013     1     1      558            600        -2      753
# ℹ 336,766 more rows
# ℹ 12 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;,
#   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,
#   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</code></pre>
</div>
</div>
</div>
</section><section id="basic-equi--joins" class="slide level2"><h2>Basic (Equi-) Joins</h2>
<p>All join functions have the same basic interface: they take a <strong>pair</strong> of data frames and return <strong>one</strong> data frame.</p>
<div class="fragment">
<p>The order of the rows and columns is primarily going to be determined by the first data frame.</p>
</div>
<div class="fragment">
<p><code>dplyr</code> has two types of joins: <em>mutating</em> and <em>filtering.</em></p>
<p><br></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="fragment">
<!-- -->
<h4 id="mutating-joins">Mutating Joins</h4>
<p>Add new variables to one data frame from matching observations from another data frame.</p>
<ul>
<li><code>left_join()</code></li>
<li><code>right_join()</code></li>
<li><code>inner_join()</code></li>
<li><code>full_join()</code></li>
</ul>
</div>
</div><div class="column" style="width:50%;">
<div class="fragment">
<!-- -->
<h4 id="filtering-joins">Filtering Joins</h4>
<p>Filter observations from one data frame based on whether or not they match an observation in another data frame.</p>
<ul>
<li><code>semi_join()</code></li>
<li><code>anti-join()</code></li>
</ul>
</div>
</div>
</div>
</div>
</section><section id="mutating-joins-1" class="slide level2"><h2><code>Mutating Joins</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<div class="fragment">
<p><img data-src="images/joins_setup.png"></p>
</div>
</div><div class="column" style="width:50%;">
<p><br></p>
<div class="fragment">
<p><img data-src="images/joins_setup2.png"></p>
</div>
</div>
</div>
</section><section id="left_join-fa-scroll" class="slide level2 scrollable"><h2>
<code>left_join()</code> <span style="color:#B7A57A"><i class="fa-solid fa-scroll" aria-label="scroll"></i></span>
</h2>
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/joins_left.png"></p>
</figure>
</div>

<aside><div>
<div>
<ul>
<li class="fragment">The most common type of join</li>
<li class="fragment">Appends columns from <code>y</code> to <code>x</code> by the rows in <code>x</code>
<ul>
<li class="fragment">
<code>NA</code> added if there is nothing from <code>y</code>
</li>
</ul>
</li>
<li class="fragment">Natural join: when all variables that appear in both datasets are used as the join key
<ul>
<li class="fragment">If the join_by() argument is not specified, <code>left_join()</code> will automatically join by all columns that have names and values in common.</li>
</ul>
</li>
</ul>
</div>
</div></aside></section><section id="left_join-in-nycflights13" class="slide level2"><h2>
<code>left_join</code> in <code>nycflights13</code>
</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>flights2 <span class="ot">&lt;-</span> flights <span class="sc">|&gt;</span> </span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">select</span>(year, time_hour, origin, dest, tailnum, carrier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>With only the pertinent variables from the <code>flights</code> dataset, we can see how a <code>left_join</code> works with the <code>airlines</code> dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>flights2 <span class="sc">|&gt;</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">left_join</span>(airlines)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(carrier)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 7
    year time_hour           origin dest  tailnum carrier name                  
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;                 
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA      United Air Lines Inc. 
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA      United Air Lines Inc. 
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA      American Airlines Inc.
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6      JetBlue Airways       
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL      Delta Air Lines Inc.  
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA      United Air Lines Inc. 
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6      JetBlue Airways       
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV      ExpressJet Airlines I…
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6      JetBlue Airways       
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA      American Airlines Inc.
# ℹ 336,766 more rows</code></pre>
</div>
</div>
</section><section id="different-variable-meanings" class="slide level2"><h2>Different variable meanings</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">left_join</span>(planes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(year, tailnum)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 13
    year time_hour           origin dest  tailnum carrier type  manufacturer
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA      &lt;NA&gt;  &lt;NA&gt;        
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA      &lt;NA&gt;  &lt;NA&gt;        
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA      &lt;NA&gt;  &lt;NA&gt;        
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6      &lt;NA&gt;  &lt;NA&gt;        
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL      &lt;NA&gt;  &lt;NA&gt;        
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA      &lt;NA&gt;  &lt;NA&gt;        
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6      &lt;NA&gt;  &lt;NA&gt;        
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV      &lt;NA&gt;  &lt;NA&gt;        
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6      &lt;NA&gt;  &lt;NA&gt;        
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA      &lt;NA&gt;  &lt;NA&gt;        
# ℹ 336,766 more rows
# ℹ 5 more variables: model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;,
#   engine &lt;chr&gt;</code></pre>
</div>
</div>
<div class="fragment">
<p>When we try to do this, however, we get a bunch of <code>NA</code>s. Why?</p>
</div>
</section><section id="different-variable-meanings-1" class="slide level2"><h2>Different variable meanings</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="fu">left_join</span>(planes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(year, tailnum)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 13
    year time_hour           origin dest  tailnum carrier type  manufacturer
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;       
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA      &lt;NA&gt;  &lt;NA&gt;        
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA      &lt;NA&gt;  &lt;NA&gt;        
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA      &lt;NA&gt;  &lt;NA&gt;        
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6      &lt;NA&gt;  &lt;NA&gt;        
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL      &lt;NA&gt;  &lt;NA&gt;        
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA      &lt;NA&gt;  &lt;NA&gt;        
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6      &lt;NA&gt;  &lt;NA&gt;        
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV      &lt;NA&gt;  &lt;NA&gt;        
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6      &lt;NA&gt;  &lt;NA&gt;        
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA      &lt;NA&gt;  &lt;NA&gt;        
# ℹ 336,766 more rows
# ℹ 5 more variables: model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;,
#   engine &lt;chr&gt;</code></pre>
</div>
</div>
<p><em>Join is trying to use tailnum and year as a compound key.</em> While both datasets have <code>year</code> as a variable, they mean different things. Therefore, we need to be explicit here about what to join by.</p>
</section><section id="different-variable-meanings-2" class="slide level2"><h2>Different variable meanings</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-53"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-53-1"><a href="#annotated-cell-53-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-53" data-target-annotation="4">4</button><span id="annotated-cell-53-2" class="code-annotation-target"><a href="#annotated-cell-53-2"></a>  <span class="fu">left_join</span>(planes, <span class="fu">join_by</span>(tailnum))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-53" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-lines="2" data-code-cell="annotated-cell-53"><code>join_by(tailnum)</code> is short for <code>join_by(tailnum == tailnum)</code> making these types of basic joins equi joins.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 14
   year.x time_hour           origin dest  tailnum carrier year.y type          
    &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;         
 1   2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA        1999 Fixed wing mu…
 2   2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA        1998 Fixed wing mu…
 3   2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA        1990 Fixed wing mu…
 4   2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6        2012 Fixed wing mu…
 5   2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL        1991 Fixed wing mu…
 6   2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA        2012 Fixed wing mu…
 7   2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6        2000 Fixed wing mu…
 8   2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV        1998 Fixed wing mu…
 9   2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6        2004 Fixed wing mu…
10   2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA          NA &lt;NA&gt;          
# ℹ 336,766 more rows
# ℹ 6 more variables: manufacturer &lt;chr&gt;, model &lt;chr&gt;, engines &lt;int&gt;,
#   seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;</code></pre>
</div>
</div>

<aside><div>
<p>When you have the same variable name but they mean different things you can specify a particular suffix with the <code>suffix</code> argument.</p>
</div></aside></section><section id="different-variable-names" class="slide level2"><h2>Different variable names</h2>
<p>If you have keys that have the same meaning (values) but are named different things in their respective datasets you’d also specify that with <code>join_by()</code></p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-54"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-54-1"><a href="#annotated-cell-54-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-54" data-target-annotation="5">5</button><span id="annotated-cell-54-2" class="code-annotation-target"><a href="#annotated-cell-54-2"></a>  <span class="fu">left_join</span>(airports, <span class="fu">join_by</span>(dest <span class="sc">==</span> faa))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-54" data-target-annotation="5">5</dt>
<dd>
<span data-code-annotation="5" data-code-lines="2" data-code-cell="annotated-cell-54"><code>by = c("dest" = "faa")</code> was the former syntax for this and you still might see that in older code.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 13
    year time_hour           origin dest  tailnum carrier name         lat   lon
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA      George Bu…  30.0 -95.3
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA      George Bu…  30.0 -95.3
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA      Miami Intl  25.8 -80.3
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6      &lt;NA&gt;        NA    NA  
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL      Hartsfiel…  33.6 -84.4
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA      Chicago O…  42.0 -87.9
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6      Fort Laud…  26.1 -80.2
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV      Washingto…  38.9 -77.5
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6      Orlando I…  28.4 -81.3
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA      Chicago O…  42.0 -87.9
# ℹ 336,766 more rows
# ℹ 4 more variables: alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>This will match <code>dest</code> to <code>faa</code> for the join and then drop <code>faa</code>.</p>
</div>
</section><section id="different-variable-names-1" class="slide level2"><h2>Different variable names</h2>
<p>You can request <code>dplyr</code> to keep both keys with <code>keep = TRUE</code> argument.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>flights2 <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2"></a>  <span class="fu">left_join</span>(airports, <span class="fu">join_by</span>(dest <span class="sc">==</span> faa), <span class="at">keep =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 336,776 × 14
    year time_hour           origin dest  tailnum carrier faa   name         lat
   &lt;int&gt; &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt;
 1  2013 2013-01-01 05:00:00 EWR    IAH   N14228  UA      IAH   George Bu…  30.0
 2  2013 2013-01-01 05:00:00 LGA    IAH   N24211  UA      IAH   George Bu…  30.0
 3  2013 2013-01-01 05:00:00 JFK    MIA   N619AA  AA      MIA   Miami Intl  25.8
 4  2013 2013-01-01 05:00:00 JFK    BQN   N804JB  B6      &lt;NA&gt;  &lt;NA&gt;        NA  
 5  2013 2013-01-01 06:00:00 LGA    ATL   N668DN  DL      ATL   Hartsfiel…  33.6
 6  2013 2013-01-01 05:00:00 EWR    ORD   N39463  UA      ORD   Chicago O…  42.0
 7  2013 2013-01-01 06:00:00 EWR    FLL   N516JB  B6      FLL   Fort Laud…  26.1
 8  2013 2013-01-01 06:00:00 LGA    IAD   N829AS  EV      IAD   Washingto…  38.9
 9  2013 2013-01-01 06:00:00 JFK    MCO   N593JB  B6      MCO   Orlando I…  28.4
10  2013 2013-01-01 06:00:00 LGA    ORD   N3ALAA  AA      ORD   Chicago O…  42.0
# ℹ 336,766 more rows
# ℹ 5 more variables: lon &lt;dbl&gt;, alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;, tzone &lt;chr&gt;</code></pre>
</div>
</div>
</div>
</section><section id="right_join" class="slide level2"><h2><code>right_join()</code></h2>

<img data-src="images/joins_right.png" class="r-stretch quarto-figure-center"><p class="caption">Has the same interface as a left_join but keeps all rows in <code>y</code> instead of <code>x</code></p></section><section id="inner_join" class="slide level2"><h2><code>inner_join()</code></h2>

<img data-src="images/joins_inner.png" class="r-stretch quarto-figure-center"><p class="caption">Has the same interface as a left_join but only keeps rows that occur in both x and y</p></section><section id="full_join" class="slide level2"><h2><code>full_join()</code></h2>

<img data-src="images/joins_full.png" class="r-stretch quarto-figure-center"><p class="caption">Has the same interface as a left_join but keeps all rows in either x or y</p></section><section id="filtering-joins-1" class="slide level2"><h2><code>Filtering Joins</code></h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><br></p>
<div class="fragment">
<p><img data-src="images/joins_setup.png"></p>
</div>
</div><div class="column" style="width:50%;">
<p><br></p>
<div class="fragment">
<p><img data-src="images/joins_setup2.png"></p>
</div>
</div>
</div>
</section><section id="semi_join" class="slide level2"><h2><code>semi_join()</code></h2>

<img data-src="images/joins_semi.png" class="r-stretch quarto-figure-center"><p class="caption">Keeps all rows in x that have a match in y</p></section><section id="semi_join-in-nycflights13" class="slide level2"><h2>
<code>semi_join()</code> in <code>nycflights13</code>
</h2>
<p>We could use a semi-join to filter the airports dataset to show just the origin airports.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2"></a>  <span class="fu">semi_join</span>(flights2, <span class="fu">join_by</span>(faa <span class="sc">==</span> origin))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 8
  faa   name                  lat   lon   alt    tz dst   tzone           
  &lt;chr&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;           
1 EWR   Newark Liberty Intl  40.7 -74.2    18    -5 A     America/New_York
2 JFK   John F Kennedy Intl  40.6 -73.8    13    -5 A     America/New_York
3 LGA   La Guardia           40.8 -73.9    22    -5 A     America/New_York</code></pre>
</div>
</div>
</div>
</section><section id="anti_join" class="slide level2"><h2><code>anti_join()</code></h2>

<img data-src="images/joins_anti.png" class="r-stretch quarto-figure-center"><p class="caption">Returns all rows in x that don’t have a match in y</p></section><section id="anti_join-in-nycflights13" class="slide level2"><h2>
<code>anti_join()</code> in <code>nycflights13</code>
</h2>
<p>We can find rows that are missing from airports by looking for flights that don’t have a matching destination airport.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a>airports <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2"></a>  <span class="fu">anti_join</span>(flights2, <span class="fu">join_by</span>(faa <span class="sc">==</span> origin))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,455 × 8
   faa   name                             lat    lon   alt    tz dst   tzone    
   &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
 1 04G   Lansdowne Airport               41.1  -80.6  1044    -5 A     America/…
 2 06A   Moton Field Municipal Airport   32.5  -85.7   264    -6 A     America/…
 3 06C   Schaumburg Regional             42.0  -88.1   801    -6 A     America/…
 4 06N   Randall Airport                 41.4  -74.4   523    -5 A     America/…
 5 09J   Jekyll Island Airport           31.1  -81.4    11    -5 A     America/…
 6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593    -5 A     America/…
 7 0G6   Williams County Airport         41.5  -84.5   730    -5 A     America/…
 8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492    -5 A     America/…
 9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000    -5 U     America/…
10 0S9   Jefferson County Intl           48.1 -123.    108    -8 A     America/…
# ℹ 1,445 more rows</code></pre>
</div>
</div>

</div>
<aside><div>
<p>This type of join is useful for finding missing values that are implicit in the data (i.e.&nbsp;<code>NA</code>s that don’t show up in the data but only exist as an absence.)</p>
</div></aside></section><section id="more-than-one-match" class="slide level2"><h2>More Than One Match</h2>

<img data-src="images/joins_match-types.png" class="r-stretch quarto-figure-center"><div class="fragment">
<p>There are three possible outcomes for a row in x:</p>
<div>
<ul>
<li class="fragment">If it doesn’t match anything, it’s dropped.</li>
<li class="fragment">If it matches 1 row in y, it’s preserved.</li>
<li class="fragment">If it matches more than 1 row in y, it’s duplicated once for each match.</li>
</ul>
</div>
</div>
<div class="fragment">
<p>What happens if we match on more than one row?</p>
</div>
</section><section id="more-than-one-match-1" class="slide level2"><h2>More Than One Match</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">key =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">val_x =</span> <span class="fu">c</span>(<span class="st">"x1"</span>, <span class="st">"x2"</span>, <span class="st">"x3"</span>))</span>
<span id="cb81-2"><a href="#cb81-2"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">key =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">val_y =</span> <span class="fu">c</span>(<span class="st">"y1"</span>, <span class="st">"y2"</span>, <span class="st">"y3"</span>))</span>
<span id="cb81-3"><a href="#cb81-3"></a></span>
<span id="cb81-4"><a href="#cb81-4"></a>df1 <span class="sc">|&gt;</span> </span>
<span id="cb81-5"><a href="#cb81-5"></a>  <span class="fu">inner_join</span>(df2, <span class="fu">join_by</span>(key))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
    key val_x val_y
  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
1     1 x1    y1   
2     2 x2    y2   
3     2 x2    y3   
4     2 x3    y2   
5     2 x3    y3   </code></pre>
</div>
</div>
<div class="fragment">
<p>If you are doing this deliberately, you can set relationship = “many-to-many”, as the warning suggests.</p>

</div>
<aside><div>
<p>Given their nature, filtering joins never duplicate rows like mutating joins do. They will only ever return a subset of the datasets.</p>
</div></aside></section><section id="non-equi-joins" class="slide level2"><h2>Non-Equi Joins</h2>
<p>The joins we’ve discussed thus far have all been equi-joins, where the rows match if the x key equals the y key. But you can also specify other types of relationships.</p>
<div class="fragment">
<p><code>dplyr</code> has four different types of non-equi joins:</p>
</div>
<div class="fragment">
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>
<strong>Cross joins</strong> match every pair of rows.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/joins_cross.png" class="absolute" style="top: 150px; right: 150px; width: 25%; "></p>
</div>
</div>

</div>
<aside><div>
<p>Cross joins, aka self-joins, are useful when generating permutations (e.g.&nbsp;creating every possible combination of values). This comes in handy when creating datasets of predicted probabilities for plotting in ggplot.</p>
</div></aside></section><section id="non-equi-joins-1" class="slide level2"><h2>Non-Equi Joins</h2>
<p>The joins we’ve discussed thus far have all been equi-joins, where the rows match if the x key equals the y key. But you can also specify other types of relationships.</p>
<p><code>dplyr</code> has four different types of non-equi joins:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>
<strong>Cross joins</strong> match every pair of rows.</li>
<li>
<strong>Inequality joins</strong> use &lt;, &lt;=, &gt;, and &gt;= instead of ==.
<ul>
<li>
<strong>Overlap joins</strong> are a special type of inequality join designed to work with ranges<sup>1</sup>.</li>
</ul>
</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/joins_inequality.png" class="absolute" style="top: 158px; right: 120px; width: 30%; "></p>
</div>
</div>

<aside><div>
<p>Inequality joins can be used to restrict the cross join so that instead of generating all permutations, we generate all combinations.</p>
</div><ol class="aside-footnotes"><li id="fn14"><p>Overlap joins provide three helpers that use inequality joins to make it easier to work with intervals: <code>between()</code>, <code><a href="https://rdrr.io/r/base/with.html">within()</a></code>, <code>overlaps()</code>. Read more about their functionality and specifications <a href="https://dplyr.tidyverse.org/reference/join_by.html?q=within#overlap-joins">here</a>.</p></li></ol></aside></section><section id="non-equi-joins-2" class="slide level2"><h2>Non-Equi Joins</h2>
<p>The joins we’ve discussed thus far have all been equi-joins, where the rows match if the x key equals the y key. But you can also specify other types of relationships.</p>
<p><code>dplyr</code> has four different types of non-equi joins:</p>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li>
<strong>Cross joins</strong> match every pair of rows.</li>
<li>
<strong>Inequality joins</strong> use &lt;, &lt;=, &gt;, and &gt;= instead of ==.
<ul>
<li>
<strong>Overlap joins</strong> are a special type of inequality join designed to work with ranges.</li>
</ul>
</li>
<li>
<strong>Rolling joins</strong> are similar to inequality joins but only find the closest match.</li>
</ul>
</div><div class="column" style="width:50%;">
<p><img data-src="images/joins_rolling.png" class="absolute" style="top: 155px; right: 35px; width: 42%; "></p>
</div>
</div>

<aside><div>
<p>Rolling joins are a special type of inequality join where instead of getting every row that satisfies the inequality, you get just the closest row. You can turn any inequality join into a rolling join by adding closest().</p>
</div></aside></section></section><section id="tidying-and-reshaping-data" class="title-slide slide level1 section-title center" data-background-color="#4B2E83"><h1>Tidying and Reshaping Data</h1>

</section><section><section id="section-2" class="title-slide slide level1 section-title center" data-menu-title="`tidyr`" data-background-image="images/tidyr.png" data-background-size="contain" data-background-position="center" data-background-color="#B7A57A"><h1></h1>

</section><section id="initial-spot-checks" class="slide level2"><h2>Initial Spot Checks</h2>
<p>First things to check after loading new data:</p>
<div>
<ul>
<li class="fragment">Did all the rows/columns from the original file make it in?
<ul>
<li class="fragment">Check using <code><a href="https://rdrr.io/r/base/dim.html">dim()</a></code> or <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>
</li>
</ul>
</li>
<li class="fragment">Are the column names in good shape?
<ul>
<li class="fragment">Use <code><a href="https://rdrr.io/r/base/names.html">names()</a></code> to check; fix with <code>rename()</code>
</li>
</ul>
</li>
<li class="fragment">Are there “decorative” blank rows or columns to remove?
<ul>
<li class="fragment">
<code><a href="https://rdrr.io/r/stats/filter.html">filter()</a></code> or <code>select()</code> out those rows/columns</li>
</ul>
</li>
<li class="fragment">How are missing values represented: <code>NA</code>, <code>" "</code> (blank), <code>.</code> (period), <code>999</code>?
<ul>
<li class="fragment">Read in the data again specifying <code>NA</code>s with the <code>na</code> argument</li>
</ul>
</li>
<li class="fragment">Are there character data (e.g.&nbsp;ZIP codes with leading zeroes) being incorrectly represented as numeric or vice versa?
<ul>
<li class="fragment">Read in the data again specifying desired <code>col_types</code>
</li>
</ul>
</li>
</ul>
</div>
</section><section id="what-is-tidy-data" class="slide level2"><h2>What is Tidy Data</h2>
<p><strong>Tidy data<sup>1</sup></strong> (aka “long data”) are such that:</p>
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/tidy-1.png"></p>
</figure>
</div>
<div>
<ol type="1">
<li class="fragment">The values for a single variable are in their own column.</li>
<li class="fragment">The values for a single observation are in their own row.</li>
<li class="fragment">There is only one value per cell.</li>
</ol>
</div>
<aside><ol class="aside-footnotes"><li id="fn15"><p>Read the original article <a href="https://www.jstatsoft.org/article/view/v059i10">here</a>.</p></li></ol></aside></section><section id="why-do-we-want-tidy-data" class="slide level2"><h2>Why do we Want Tidy Data?</h2>
<div>
<ul>
<li class="fragment">
<strong>Easier to understand</strong> many rows than many columns<sup>1</sup>
</li>
<li class="fragment">Required for <strong>plotting</strong> in <code>ggplot2</code><sup>2</sup>
</li>
<li class="fragment">Required for many types of <strong>statistical procedures</strong> (e.g.&nbsp;hierarchical or mixed effects models)</li>
<li class="fragment">Fewer issues with <strong>missing values and “imbalanced”</strong> repeated measures data</li>
<li class="fragment">Having a consistent method for storing data means it’s easier to learn the tools to work with it since there’s an underlying uniformity.</li>
</ul>
</div>
<div class="fragment">
<p>Most real-world data is not tidy because data are often organized for goals other than analysis (i.e.&nbsp;data entry) and most people aren’t familiar with the principles of tidy data.</p>
</div>
<aside><ol class="aside-footnotes"><li id="fn16"><p>Placing variables in columns also leverages <code>R</code>’s vectorized nature, i.e.&nbsp;most built-in <code>R</code> functions work with values of vectors.</p></li><li id="fn17"><p>In fact, all tidyverse functions are designed to work with tidy data.</p></li></ol></aside></section><section id="slightly-messy-data" class="slide level2"><h2>Slightly “Messy” Data</h2>
<div class="columns">
<div class="column" style="width:60%;">
<table>
<thead><tr class="header">
<th><strong>Program</strong></th>
<th style="text-align: right;"><strong>First Year</strong></th>
<th style="text-align: right;"><strong>Second Year</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Evans School</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td>Arts &amp; Sciences</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>Public Health</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td>Other</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:40%;">
<ul>
<li>What is an <strong>observation</strong>?
<ul>
<li>A group of students from a program of a given year</li>
</ul>
</li>
<li>What are the <strong>variables</strong>?
<ul>
<li>Program, Year</li>
</ul>
</li>
<li>What are the <strong>values</strong>?
<ul>
<li>Program: Evans School, Arts &amp; Sciences, Public Health, Other</li>
<li>Year: First, Second – <strong>in column headings. Bad!</strong>
</li>
<li>Count: <strong>spread over two columns!</strong>
</li>
</ul>
</li>
</ul>
</div>
</div>
</section><section id="tidy-version" class="slide level2"><h2>Tidy Version</h2>
<div class="columns">
<div class="column" style="width:50%;">
<table>
<thead><tr class="header">
<th><strong>Program</strong></th>
<th style="text-align: right;"><strong>Year</strong></th>
<th style="text-align: right;"><strong>Count</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Evans School</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td>Evans School</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>Arts &amp; Sciences</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>Arts &amp; Sciences</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td>Public Health</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td>Public Health</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td>Other</td>
<td style="text-align: right;">First</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td>Other</td>
<td style="text-align: right;">Second</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Each variable is a column.</p></li>
<li><p>Each observation is a row.</p></li>
<li><p>Each cell has a single value.</p></li>
</ul>
</div>
</div>
</section><section id="billboard-is-just-ugly-messy" class="slide level2"><h2>Billboard is Just Ugly-Messy</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 81
    year artist     track time  date.entered   wk1   wk2   wk3   wk4   wk5   wk6
   &lt;int&gt; &lt;chr&gt;      &lt;chr&gt; &lt;tim&gt; &lt;date&gt;       &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
 1  2000 2 Pac      Baby… 04:22 2000-02-26      87    82    72    77    87    94
 2  2000 2Ge+her    The … 03:15 2000-09-02      91    87    92    NA    NA    NA
 3  2000 3 Doors D… Kryp… 03:53 2000-04-08      81    70    68    67    66    57
 4  2000 3 Doors D… Loser 04:24 2000-10-21      76    76    72    69    67    65
 5  2000 504 Boyz   Wobb… 03:35 2000-04-15      57    34    25    17    17    31
 6  2000 98^0       Give… 03:24 2000-08-19      51    39    34    26    26    19
 7  2000 A*Teens    Danc… 03:44 2000-07-08      97    97    96    95   100    NA
 8  2000 Aaliyah    I Do… 04:15 2000-01-29      84    62    51    41    38    35
 9  2000 Aaliyah    Try … 04:03 2000-03-18      59    53    38    28    21    18
10  2000 Adams, Yo… Open… 05:30 2000-08-26      76    76    74    69    68    67
# ℹ 70 more variables: wk7 &lt;int&gt;, wk8 &lt;int&gt;, wk9 &lt;int&gt;, wk10 &lt;int&gt;, wk11 &lt;int&gt;,
#   wk12 &lt;int&gt;, wk13 &lt;int&gt;, wk14 &lt;int&gt;, wk15 &lt;int&gt;, wk16 &lt;int&gt;, wk17 &lt;int&gt;,
#   wk18 &lt;int&gt;, wk19 &lt;int&gt;, wk20 &lt;int&gt;, wk21 &lt;int&gt;, wk22 &lt;int&gt;, wk23 &lt;int&gt;,
#   wk24 &lt;int&gt;, wk25 &lt;int&gt;, wk26 &lt;int&gt;, wk27 &lt;int&gt;, wk28 &lt;int&gt;, wk29 &lt;int&gt;,
#   wk30 &lt;int&gt;, wk31 &lt;int&gt;, wk32 &lt;int&gt;, wk33 &lt;int&gt;, wk34 &lt;int&gt;, wk35 &lt;int&gt;,
#   wk36 &lt;int&gt;, wk37 &lt;int&gt;, wk38 &lt;int&gt;, wk39 &lt;int&gt;, wk40 &lt;int&gt;, wk41 &lt;int&gt;,
#   wk42 &lt;int&gt;, wk43 &lt;int&gt;, wk44 &lt;int&gt;, wk45 &lt;int&gt;, wk46 &lt;int&gt;, wk47 &lt;int&gt;, …</code></pre>
</div>
</div>

<aside><div>
<p>Week columns continue up to <code>wk76</code>!</p>
</div></aside></section><section id="billboard" class="slide level2"><h2>Billboard</h2>
<div>
<ul>
<li class="fragment">What are the <strong>observations</strong> in the data?
<ul>
<li class="fragment">Song on the Billboard chart each week</li>
</ul>
</li>
<li class="fragment">What are the <strong>variables</strong> in the data?
<ul>
<li class="fragment">Year, artist, track, song length, date entered Hot 100, week since first entered Hot 100 (<strong>spread over many columns</strong>), rank during week (<strong>spread over many columns</strong>)</li>
</ul>
</li>
<li class="fragment">What are the <strong>values</strong> in the data?
<ul>
<li class="fragment">e.g.&nbsp;2000; 3 Doors Down; Kryptonite; 3 minutes 53 seconds; April 8, 2000; Week 3 (<strong>stuck in column headings</strong>); rank 68 (<strong>spread over many columns</strong>)</li>
</ul>
</li>
</ul>
</div>
</section><section id="tidyr" class="slide level2"><h2><code>tidyr</code></h2>
<p>The <code>tidyr</code> package provides functions to tidy up data.</p>
<div class="fragment">
<p><strong>Key functions:</strong></p>
<ul>
<li>
<strong><code>pivot_longer()</code></strong>: takes a set of columns and pivots them down (“longer”) to make two new columns (which you can name yourself):
<ul>
<li>A <code>name</code> column that stores the original column names</li>
<li>A <code>value</code> with the values in those original columns</li>
</ul>
</li>
</ul>
</div>
<div class="fragment">
<ul>
<li>
<strong><code>pivot_wider()</code></strong>: inverts <code>pivot_longer()</code> by taking two columns and pivoting them up and across (“wider”) into multiple columns</li>
</ul>
</div>
</section><section id="pivot_longer" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<div>
<ol type="1">
<li class="fragment">
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li class="fragment">
<code>names_to</code>: Names the new variable that is stored in multiple columns</li>
<li class="fragment">
<code>values_to</code>: Names the variable stored in the cell values</li>
</ol>
</div>
</section><section id="pivot_longer-1" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li>
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li><strong><code>names_to</code>: Names the new variable that is stored in multiple columns</strong></li>
<li>
<code>values_to</code>: Names the variable stored in the cell values</li>
</ol>

<img data-src="images/pivot_longer2_column_names.png" class="r-stretch quarto-figure-center"></section><section id="pivot_longer-2" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li>
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li>
<code>names_to</code>: Names the new variable that is stored in multiple columns</li>
<li><strong><code>values_to</code>: Names the variable stored in the cell values</strong></li>
</ol>

<img data-src="images/pivot_longer3_cell_values.png" class="r-stretch quarto-figure-center"></section><section id="pivot_longer-3" class="slide level2"><h2><code>pivot_longer()</code></h2>
<p>This function usually takes three arguments:</p>
<ol type="1">
<li>
<code>cols</code>: The columns that need to be pivoted (are not variables)</li>
<li>
<code>names_to</code>: Names the new variable that is stored in multiple columns</li>
<li>
<code>values_to</code>: Names the variable stored in the cell values</li>
</ol>

<img data-src="images/pivot_longer1_variables.png" class="r-stretch quarto-figure-center"></section><section id="pivot_longer-example" class="slide level2"><h2>
<code>pivot_longer()</code> Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-59"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-59-1"><a href="#annotated-cell-59-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_2000_raw <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-59" data-target-annotation="1">1</button><span id="annotated-cell-59-2" class="code-annotation-target"><a href="#annotated-cell-59-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"wk"</span>),</span>
<span id="annotated-cell-59-3"><a href="#annotated-cell-59-3"></a>               <span class="at">names_to =</span><span class="st">"week"</span>,</span>
<span id="annotated-cell-59-4"><a href="#annotated-cell-59-4"></a>               <span class="at">values_to =</span> <span class="st">"rank"</span>)</span>
<span id="annotated-cell-59-5"><a href="#annotated-cell-59-5"></a></span>
<span id="annotated-cell-59-6"><a href="#annotated-cell-59-6"></a>billboard_2000 <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-59" data-target-annotation="1">1</dt>
<dd>
<span data-code-annotation="1" data-code-lines="2" data-code-cell="annotated-cell-59"><code>starts_with()</code> is one of the helper functions from <a href="https://tidyselect.r-lib.org/index.html"><code>tidyselect</code></a> that helps select certain common patterns. We could have also used <code>cols = wk1:wk76</code>.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 7
    year artist track                   time   date.entered week   rank
   &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;                   &lt;time&gt; &lt;date&gt;       &lt;chr&gt; &lt;int&gt;
 1  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk1      87
 2  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk2      82
 3  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk3      72
 4  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk4      77
 5  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk5      87
 6  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk6      94
 7  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk7      99
 8  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk8      NA
 9  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk9      NA
10  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26   wk10     NA</code></pre>
</div>
</div>
<div class="fragment">
<p>Now we have a single week column!</p>
</div>
</section><section id="lots-of-missing-values" class="slide level2"><h2>Lots of Missing Values?!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">glimpse</span>(billboard_2000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 24,092
Columns: 7
$ year         &lt;int&gt; 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 2000, 200…
$ artist       &lt;chr&gt; "2 Pac", "2 Pac", "2 Pac", "2 Pac", "2 Pac", "2 Pac", "2 …
$ track        &lt;chr&gt; "Baby Don't Cry (Keep...", "Baby Don't Cry (Keep...", "Ba…
$ time         &lt;time&gt; 04:22:00, 04:22:00, 04:22:00, 04:22:00, 04:22:00, 04:22:…
$ date.entered &lt;date&gt; 2000-02-26, 2000-02-26, 2000-02-26, 2000-02-26, 2000-02-…
$ week         &lt;chr&gt; "wk1", "wk2", "wk3", "wk4", "wk5", "wk6", "wk7", "wk8", "…
$ rank         &lt;int&gt; 87, 82, 72, 77, 87, 94, 99, NA, NA, NA, NA, NA, NA, NA, N…</code></pre>
</div>
</div>
<div class="fragment">
<p>It looks like 2 Pac’s song “Baby Don’t Cry” was only on the Billboard Hot 100 for 7 weeks and then dropped off the charts.</p>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">summary</span>(billboard_2000<span class="sc">$</span>rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   1.00   26.00   51.00   51.05   76.00  100.00   18785 </code></pre>
</div>
</div>
<div class="fragment">
<p>We don’t want to keep the 18785 rows with missing ranks.</p>
</div>
</div>
</section><section id="pivoting-better-values_drop_na" class="slide level2"><h2>Pivoting Better: <code>values_drop_na</code>
</h2>
<p>Adding the argument <code>values_drop_na = TRUE</code> to <code>pivot_longer()</code> will remove rows with missing ranks. Since these <code>NA</code>s don’t really represent unknown observations (i.e.&nbsp;they were forced to exist by the structure of the dataset) this is an appropriate approach here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89" data-code-line-numbers="|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_2000_raw <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> wk1<span class="sc">:</span>wk76, </span>
<span id="cb89-3"><a href="#cb89-3"></a>               <span class="at">names_to =</span> <span class="st">"week"</span>, </span>
<span id="cb89-4"><a href="#cb89-4"></a>               <span class="at">values_to =</span> <span class="st">"rank"</span>, </span>
<span id="cb89-5"><a href="#cb89-5"></a>               <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-6"><a href="#cb89-6"></a><span class="fu">summary</span>(billboard_2000<span class="sc">$</span>rank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00   26.00   51.00   51.05   76.00  100.00 </code></pre>
</div>
</div>
<div class="fragment">
<p>No more <code>NA</code> values!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">dim</span>(billboard_2000)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5307    7</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>And way fewer rows!</p>
</div>
</section><section id="parse_number" class="slide level2"><h2><code>parse_number()</code></h2>
<p>The week column is of the type <code>character</code>, but it should be <code>numeric.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">head</span>(billboard_2000<span class="sc">$</span>week)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "wk1" "wk2" "wk3" "wk4" "wk5" "wk6"</code></pre>
</div>
</div>
<div class="fragment">
<p><code>parse_number()</code> grabs just the numeric information from a character string:</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-65"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-65-1"><a href="#annotated-cell-65-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_2000 <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-65" data-target-annotation="2">2</button><span id="annotated-cell-65-2" class="code-annotation-target"><a href="#annotated-cell-65-2"></a>    <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">parse_number</span>(week))</span>
<span id="annotated-cell-65-3"><a href="#annotated-cell-65-3"></a><span class="fu">summary</span>(billboard_2000<span class="sc">$</span>week)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-65" data-target-annotation="2">2</dt>
<dd>
<span data-code-annotation="2" data-code-lines="2" data-code-cell="annotated-cell-65">You can use <code>mutate()</code> to overwrite existing columns.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    5.00   10.00   11.47   16.00   65.00 </code></pre>
</div>
</div>
</div>
</section><section id="use-pivot_longer-arguments" class="slide level2"><h2>Use <code>pivot_longer</code> arguments</h2>
<p>Alternatively (and more efficiently), there are a number of optional arguments for <code>pivot_longer</code> that are meant to help deal with naming issues.</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-66"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-66-1"><a href="#annotated-cell-66-1"></a>billboard_2000 <span class="ot">&lt;-</span> billboard_2000_raw <span class="sc">%&gt;%</span></span>
<span id="annotated-cell-66-2"><a href="#annotated-cell-66-2"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"wk"</span>), </span>
<span id="annotated-cell-66-3"><a href="#annotated-cell-66-3"></a>               <span class="at">names_to        =</span> <span class="st">"week"</span>, </span>
<span id="annotated-cell-66-4"><a href="#annotated-cell-66-4"></a>               <span class="at">values_to       =</span> <span class="st">"rank"</span>,</span>
<span id="annotated-cell-66-5"><a href="#annotated-cell-66-5"></a>               <span class="at">values_drop_na  =</span> <span class="cn">TRUE</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-66" data-target-annotation="3">3</button><span id="annotated-cell-66-6" class="code-annotation-target"><a href="#annotated-cell-66-6"></a>               <span class="at">names_prefix    =</span> <span class="st">"wk"</span>,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-66" data-target-annotation="4">4</button><span id="annotated-cell-66-7" class="code-annotation-target"><a href="#annotated-cell-66-7"></a>               <span class="at">names_transform =</span> <span class="fu">list</span>(<span class="at">week =</span> as.integer))</span>
<span id="annotated-cell-66-8"><a href="#annotated-cell-66-8"></a></span>
<span id="annotated-cell-66-9"><a href="#annotated-cell-66-9"></a><span class="fu">head</span>(billboard_2000, <span class="dv">5</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-66" data-target-annotation="3">3</dt>
<dd>
<span data-code-annotation="3" data-code-lines="6" data-code-cell="annotated-cell-66"><code>names_prefix</code> is used to remove “wk” from the values of <code>week</code></span>
</dd>
<dt data-target-cell="annotated-cell-66" data-target-annotation="4">4</dt>
<dd>
<span data-code-annotation="4" data-code-lines="7" data-code-cell="annotated-cell-66"><code>names_transform</code> converts <code>week</code> into an integer number.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 7
   year artist track                   time   date.entered  week  rank
  &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;                   &lt;time&gt; &lt;date&gt;       &lt;int&gt; &lt;int&gt;
1  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       1    87
2  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       2    82
3  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       3    72
4  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       4    77
5  2000 2 Pac  Baby Don't Cry (Keep... 04:22  2000-02-26       5    87</code></pre>
</div>
</div>
</div>
</section><section id="multiple-variables-in-column-names" class="slide level2"><h2>Multiple Variables in Column Names</h2>
<p>A more challenging situation occurs when you have multiple pieces of information crammed into the column names, and you would like to store these in separate new variables.</p>
<div class="fragment">
<p>This dataset contains tuberculosis diagnoses collected by the World Health Organization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>who2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,240 × 58
   country      year sp_m_014 sp_m_1524 sp_m_2534 sp_m_3544 sp_m_4554 sp_m_5564
   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Afghanistan  1980       NA        NA        NA        NA        NA        NA
 2 Afghanistan  1981       NA        NA        NA        NA        NA        NA
 3 Afghanistan  1982       NA        NA        NA        NA        NA        NA
 4 Afghanistan  1983       NA        NA        NA        NA        NA        NA
 5 Afghanistan  1984       NA        NA        NA        NA        NA        NA
 6 Afghanistan  1985       NA        NA        NA        NA        NA        NA
 7 Afghanistan  1986       NA        NA        NA        NA        NA        NA
 8 Afghanistan  1987       NA        NA        NA        NA        NA        NA
 9 Afghanistan  1988       NA        NA        NA        NA        NA        NA
10 Afghanistan  1989       NA        NA        NA        NA        NA        NA
# ℹ 7,230 more rows
# ℹ 50 more variables: sp_m_65 &lt;dbl&gt;, sp_f_014 &lt;dbl&gt;, sp_f_1524 &lt;dbl&gt;,
#   sp_f_2534 &lt;dbl&gt;, sp_f_3544 &lt;dbl&gt;, sp_f_4554 &lt;dbl&gt;, sp_f_5564 &lt;dbl&gt;,
#   sp_f_65 &lt;dbl&gt;, sn_m_014 &lt;dbl&gt;, sn_m_1524 &lt;dbl&gt;, sn_m_2534 &lt;dbl&gt;,
#   sn_m_3544 &lt;dbl&gt;, sn_m_4554 &lt;dbl&gt;, sn_m_5564 &lt;dbl&gt;, sn_m_65 &lt;dbl&gt;,
#   sn_f_014 &lt;dbl&gt;, sn_f_1524 &lt;dbl&gt;, sn_f_2534 &lt;dbl&gt;, sn_f_3544 &lt;dbl&gt;,
#   sn_f_4554 &lt;dbl&gt;, sn_f_5564 &lt;dbl&gt;, sn_f_65 &lt;dbl&gt;, ep_m_014 &lt;dbl&gt;, …</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>The first two columns are self explanatory but what’s going on with the rest?</p>
</div>
</section><section id="multiple-variables-in-column-names-1" class="slide level2"><h2>Multiple Variables in Column Names</h2>
<p>Data documentation and some minor investigation would lead you to figure out that the three elements in each of these column names are actually data!</p>
<ul>
<li>The first piece, <code>sp</code>/<code>sn</code>/<code>rel</code>/<code>ep</code>, describes the method used for the diagnosis</li>
<li>The second piece, <code>m</code>/<code>f</code> is the gender (coded as a binary variable in this dataset)</li>
<li>The third piece, <code>014</code>/<code>1524</code>/<code>2534</code>/<code>3544</code>/<code>4554</code>/<code>5564</code>/<code>65</code> is the age range (014 represents 0-14, for example)</li>
</ul>
<div class="fragment">
<p>To organize the six pieces of information in this dataset into six separate columns, we use <code>pivot_longer()</code> with a vector of column names for <code>names_to</code> and instructors for splitting the original variable names into pieces for <code>names_sep</code> as well as a column name for <code>values_to</code>!</p>
</div>
</section><section id="multiple-variables-in-column-names-2" class="slide level2"><h2>Multiple Variables in Column Names</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-68"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-68-1"><a href="#annotated-cell-68-1"></a>who2 <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-68-2"><a href="#annotated-cell-68-2"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="annotated-cell-68-3"><a href="#annotated-cell-68-3"></a>    <span class="at">cols =</span> <span class="sc">!</span>(country<span class="sc">:</span>year),</span>
<span id="annotated-cell-68-4"><a href="#annotated-cell-68-4"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>), </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-68" data-target-annotation="5">5</button><span id="annotated-cell-68-5" class="code-annotation-target"><a href="#annotated-cell-68-5"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="annotated-cell-68-6"><a href="#annotated-cell-68-6"></a>    <span class="at">values_to =</span> <span class="st">"count"</span></span>
<span id="annotated-cell-68-7"><a href="#annotated-cell-68-7"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-68" data-target-annotation="5">5</dt>
<dd>
<span data-code-annotation="5" data-code-lines="5" data-code-cell="annotated-cell-68">You can use <code>names_pattern</code> instead of <code>names_sep</code> to extract variables from more complicated naming scenarios once you’ve learned regular expressions in a few weeks.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 405,440 × 6
   country      year diagnosis gender age   count
   &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;
 1 Afghanistan  1980 sp        m      014      NA
 2 Afghanistan  1980 sp        m      1524     NA
 3 Afghanistan  1980 sp        m      2534     NA
 4 Afghanistan  1980 sp        m      3544     NA
 5 Afghanistan  1980 sp        m      4554     NA
 6 Afghanistan  1980 sp        m      5564     NA
 7 Afghanistan  1980 sp        m      65       NA
 8 Afghanistan  1980 sp        f      014      NA
 9 Afghanistan  1980 sp        f      1524     NA
10 Afghanistan  1980 sp        f      2534     NA
# ℹ 405,430 more rows</code></pre>
</div>
</div>
</section><section id="variable-values-in-column-names" class="slide level2"><h2>Variable &amp; Values in Column Names</h2>
<p>This dataset contains data about five families, with the names and dates of birth of up to two children.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>household</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 5
  family dob_child1 dob_child2 name_child1 name_child2
   &lt;int&gt; &lt;date&gt;     &lt;date&gt;     &lt;chr&gt;       &lt;chr&gt;      
1      1 1998-11-26 2000-01-29 Susan       Jose       
2      2 1996-06-22 NA         Mark        &lt;NA&gt;       
3      3 2002-07-11 2004-04-05 Sam         Seth       
4      4 2004-10-10 2009-08-27 Craig       Khai       
5      5 2000-12-05 2005-02-28 Parker      Gracie     </code></pre>
</div>
</div>
<div class="fragment">
<p>The new challenge in this dataset is that the column names contain the names of two variables (<code>dob</code>, <code>name</code>) and the values of another (<code>child</code>, with values <code>1</code> or <code>2</code>).</p>
</div>
</section><section id="variable-values-in-column-names-1" class="slide level2"><h2>Variable &amp; Values in Column Names</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="annotated-cell-70"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-70-1"><a href="#annotated-cell-70-1"></a>household <span class="sc">|&gt;</span> </span>
<span id="annotated-cell-70-2"><a href="#annotated-cell-70-2"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="annotated-cell-70-3"><a href="#annotated-cell-70-3"></a>    <span class="at">cols =</span> <span class="sc">!</span>family, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-70" data-target-annotation="6">6</button><span id="annotated-cell-70-4" class="code-annotation-target"><a href="#annotated-cell-70-4"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">".value"</span>, <span class="st">"child"</span>),</span>
<span id="annotated-cell-70-5"><a href="#annotated-cell-70-5"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-70" data-target-annotation="7">7</button><span id="annotated-cell-70-6" class="code-annotation-target"><a href="#annotated-cell-70-6"></a>    <span class="at">values_drop_na =</span> <span class="cn">TRUE</span></span>
<span id="annotated-cell-70-7"><a href="#annotated-cell-70-7"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="column fragment">
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-70" data-target-annotation="6">6</dt>
<dd>
<span data-code-annotation="6" data-code-lines="4" data-code-cell="annotated-cell-70"><code>.value</code> isn’t the name of a variable but a unique value that tells <code>pivot_longer</code> to use the first component of the pivoted column name as a variable name in the output.</span>
</dd>
<dt data-target-cell="annotated-cell-70" data-target-annotation="7">7</dt>
<dd>
<span data-code-annotation="7" data-code-lines="6" data-code-cell="annotated-cell-70">Using <code>values_drop_na = TRUE</code> again since not every family has 2 children.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  family child  dob        name  
   &lt;int&gt; &lt;chr&gt;  &lt;date&gt;     &lt;chr&gt; 
1      1 child1 1998-11-26 Susan 
2      1 child2 2000-01-29 Jose  
3      2 child1 1996-06-22 Mark  
4      3 child1 2002-07-11 Sam   
5      3 child2 2004-04-05 Seth  
6      4 child1 2004-10-10 Craig 
7      4 child2 2009-08-27 Khai  
8      5 child1 2000-12-05 Parker
9      5 child2 2005-02-28 Gracie</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure><p><img data-src="images/pivot_longer5_names-and-values.png" style="width:75.0%"></p>
</figure>
</div>
</div>
</section><section id="pivot_wider" class="slide level2"><h2><code>pivot_wider</code></h2>
<p><code>pivot_wider()</code> is the opposite of <code>pivot_longer()</code>, which you use if you have data for the same observation taking up multiple rows.</p>
<div class="fragment">
<p>Here’s an example of data that we probably want to pivot wider (unless we want to plot each statistic in its own facet):</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  Group Statistic Value
  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt;
1 A     Mean       1.28
2 A     Median     1   
3 A     SD         0.72
4 B     Mean       2.81
5 B     Median     2   
6 B     SD         1.33</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>A common cue to use <code>pivot_wider()</code> is having measurements of different quantities in the same column.</p>
</div>
</section><section id="pivot_wider-example" class="slide level2"><h2>
<code>pivot_wider</code> Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-71"><pre class="sourceCode numberSource r code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-71-1"><a href="#annotated-cell-71-1"></a>wide_stats <span class="ot">&lt;-</span> long_stats <span class="sc">|&gt;</span> </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-71" data-target-annotation="8">8</button><span id="annotated-cell-71-2" class="code-annotation-target"><a href="#annotated-cell-71-2"></a>  <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> Group,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-71" data-target-annotation="9">9</button><span id="annotated-cell-71-3" class="code-annotation-target"><a href="#annotated-cell-71-3"></a>              <span class="at">names_from =</span> Statistic,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-71" data-target-annotation="10">10</button><span id="annotated-cell-71-4" class="code-annotation-target"><a href="#annotated-cell-71-4"></a>              <span class="at">values_from =</span> Value)</span>
<span id="annotated-cell-71-5"><a href="#annotated-cell-71-5"></a>wide_stats</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-71" data-target-annotation="8">8</dt>
<dd>
<span data-code-annotation="8" data-code-lines="2" data-code-cell="annotated-cell-71"><code>id_cols</code> is the column that uniquely identifies each row in the new dataset. Default is everything not in <code>names_from</code> and <code>values_from</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-71" data-target-annotation="9">9</dt>
<dd>
<span data-code-annotation="9" data-code-lines="3" data-code-cell="annotated-cell-71"><code>names_from</code> provides the names that will be used for the new columns</span>
</dd>
<dt data-target-cell="annotated-cell-71" data-target-annotation="10">10</dt>
<dd>
<span data-code-annotation="10" data-code-lines="4" data-code-cell="annotated-cell-71"><code>values_from</code> provides the values that will be used to populate the cells of the new columns.</span>
</dd>
</dl>
</div>
</div>
<div class="cell fragment">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Group  Mean Median    SD
  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 A      1.28      1  0.72
2 B      2.81      2  1.33</code></pre>
</div>
</div>
<div class="fragment">
<p><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html"><code>pivot_wider()</code></a> also has a number of optional <code>names_*</code> and <code>values_*</code> arguments for more complicated transformations.</p>
</div>
<div class="fragment">
<div class="callout callout-warning no-icon callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<p><strong><span style="color:orange"><i class="fa-solid fa-triangle-exclamation" aria-label="triangle-exclamation"></i></span> Nested Data</strong></p>
</div>
<div class="callout-content">
<p>If there are multiple rows in the input that correspond to one cell in the output you’ll get a list-column. This means that you 1) need to fix something in your code/data because it shouldn’t be nested in this way or 2) need to use <code>unnest_wider()</code> or <code>unnest_longer()</code> in order to access this column of data. More on this <a href="https://r4ds.hadley.nz/rectangling.html#unnesting">here</a>.</p>
</div>
</div>
</div>
</div>
</section></section><section id="thanks" class="title-slide slide level1 section-title center" data-background-color="#4B2E83"><h1>Thanks!</h1>

</section><section><section id="section-3" class="title-slide slide level1 section-title center" data-menu-title="R Knowledge Comic" data-background-image="images/r_knowledge.png"><h1></h1>

</section><section id="useful-resources" class="slide level2"><h2>Useful Resources</h2>
<div class="fragment">
<h4 id="cheatsheets">Cheatsheets</h4>
<ul>
<li><a href="https://rstudio.github.io/cheatsheets/data-import.pdf">readr</a></li>
<li><a href="https://rstudio.github.io/cheatsheets/data-transformation.pdf">dplyr</a></li>
<li><a href="https://rstudio.github.io/cheatsheets/tidyr.pdf">tidyr</a></li>
</ul>
<p>. . .</p>
<h4 id="introductory-book">Introductory Book</h4>
<p><a href="https://r4ds.hadley.nz/">R for Data Science (2e)</a> by Hadley Wickham</p>

<div class="footer footer-default">

</div>
</div>
</section></section>
</div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="../site_libs/revealjs/dist/reveal.js"></script><!-- reveal.js plugins --><script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script><script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script><script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script><script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script><script src="../site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script><script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script><script src="../site_libs/revealjs/plugin/notes/notes.js"></script><script src="../site_libs/revealjs/plugin/search/search.js"></script><script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script><script src="../site_libs/revealjs/plugin/math/math.js"></script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'pointer': {"key":"q","color":"#b18eb1","pointerSize":16,"alwaysVisible":false},
'smaller': true,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script><script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script><script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Handle positioning of the toggle
          window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
              // default icon
              link.classList.add("external");
          }
        }
    });
    </script>


</body></html>